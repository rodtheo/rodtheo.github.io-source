<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Rodrigo Theodoro">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Optimizing Python in the Real World: NumPy, Numba, and the NUFFT | </title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title=" blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/icons.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
a {
  color: #007EE5;
  text-decoration: none;
}
a:hover {
  color: #007EE5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #205F29;
  margin-bottom: 0px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  max-width: 1000px;
}
header.main-header .container nav a:hover {
  background-color: #5C881C;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  margin-bottom: 20px;
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  font-size: 0.85em;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  font-size: 0.85em;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 16px;
  margin-bottom: 20px;
  line-height: 1.6em;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 13px;
}
article .meta {
  font-size: 11px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  margin-bottom: 20px;
  display: block;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #205F29;
  background: #FFF;
  border: 1px solid #205F29;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #5C881C;
}
.index {
  max-width: 700px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
.index article header h2 a {
  color: #000;
}
.index article header h2 a:hover {
  color: #007EE5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #5C881C;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #5C881C;
}
.index .pagination a:hover {
  color: #FFF;
  background: #5C881C;
}
.post {
  max-width: 700px;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post article .meta {
  margin: 50px 0 100px;
}
.list {
  max-width: 700px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 1em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
        <script type="text/javascript">
        init_mathjax = function() {
            if (window.MathJax) {
                // MathJax loaded
                MathJax.Hub.Config({
                    tex2jax: {
                        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                    },
                    displayAlign: 'left', // Change this to 'center' to center equations.
                    "HTML-CSS": {
                        styles: {'.MathJax_Display': {"margin": 0}}
                    }
                });
                MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
            }
        }
        init_mathjax();
        </script>

    </head>

    <body>
        <header class="navbar navbar-inverse bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title"></a>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav navbar-right">
                            <li><a href="/pages/about.html" title="About">About</a></li>
                            <li><a href="/archives.html" title="Archive">Archive</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>Optimizing Python in the Real World: NumPy, Numba, and the NUFFT</h1>
            <time datetime="article.date.isoformat()" pubdate>Tue 24 February 2015</time>
        </header>

        <div class="article_content">
            <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">


<p>Donald Knuth famously quipped that "premature optimization is the root of all evil."
The reasons are straightforward: optimized code tends to be much more difficult to read and debug than simpler implementations of the same algorithm, and optimizing too early leads to greater costs down the road.
In the Python world, there is another cost to optimization: optimized code often is written in a compiled language like Fortran or C, and this leads to barriers to its development, use, and deployment.</p>
<p>Too often, tutorials about optimizing Python use trivial or toy examples which may not map well to the real world.
I've certainly been <a href="https://jakevdp.github.io/blog/2012/08/24/numba-vs-cython/">guilty</a> of this <a href="https://jakevdp.github.io/blog/2013/06/15/numba-vs-cython-take-2/">myself</a>.
Here, I'm going to take a different route: in this post I will outline the process of understanding, implementing, and optimizing a non-trivial algorithm in Python, in this case the <a href="http://www.cims.nyu.edu/cmcl/nufft/nufft.html">Non-uniform Fast Fourier Transform</a> (NUFFT).
Along the way, we'll dig into the process of optimizing Python code, and see how a relatively straightforward pure Python implementation, with a little help from <a href="http://numba.pydata.org">Numba</a>, can be made to nearly match the performance of a highly-optimized Fortran implementation of the same algorithm.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Why-a-Python-Implementation?">Why a Python Implementation?<a class="anchor-link" href="#Why-a-Python-Implementation?">&#182;</a></h2><p>First, I want to answer the inevitable question: why spend the time to make a Python implementation of an algorithm that's already out there in Fortran?
The reason is that I've found in my research and teaching that pure-Python implementations of algorithms are far more valuable than C or Fortran implementations, even if they might be a bit slower.
This is for a number of reasons:</p>
<ul>
<li><p><strong>Pure-Python code is easier to read, understand, and contribute to.</strong> Good Python implementations are much higher-level than C or Fortran, and abstract-away loop indices, bit twiddling,  workspace arrays, and other sources of code clutter. A typical student reading good Python code can immediately understand and modify the algorithm, while the same student would be lost trying to understand typical optimized Fortran code.</p>
</li>
<li><p><strong>Pure-python packages are much easier to install than Python-wrapped C or Fortran code.</strong> This is especially true on non-Linux systems. Fortran in particular can require some installation prerequisites that are non-trivial for many users. In practice, I've seen people give up on better tools when there is an installation barrier for those tools.</p>
</li>
<li><p><strong>Pure-python code often works for many data types.</strong> Because of the way it is written, pure Python code is often automatically applicable to single or double precision, and perhaps even to extensions to complex numbers. For compiled packages, supporting and compiling for all possible types can be a burden.</p>
</li>
<li><p><strong>Pure-python is easier to use at scale.</strong> Because it does not require complicated installation, pure Python packages can be much easier to install on cloud VMs and/or shared clusters for computation at scale. If you can easily pip-install a pure-Python package on a VM, then services like AWS and TravisCI are much easier to set up.</p>
</li>
</ul>
<p>Certainly code speed will overcome these considerations if the performance gap is great enough, but I've found that for many applications a pure Python package, cleverly designed and optimized, can be made fast enough that these larger considerations win-out. The challenge is making the Python fast. We'll explore this below.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Background:-The-Non-Uniform-Fast-Fourier-Transform">Background: The Non-Uniform Fast Fourier Transform<a class="anchor-link" href="#Background:-The-Non-Uniform-Fast-Fourier-Transform">&#182;</a></h2><p>The Fast Fourier Transform (FFT) is perhaps the most important and fundamental of modern numerical algorithms.
It provides a fast, $O[N\log N]$ method of computing the discrete Fourier transform:
$$
Y_k^\pm = \sum_{n=0}^{N-1} y_n e^{\pm i k n / N}
$$
You can read more about the FFT in <a href="https://jakevdp.github.io/blog/2013/08/28/understanding-the-fft/">my previous post</a> on the subject.</p>
<p>One important limitation of the FFT is that it requires that input data be evenly-spaced: that is, we can think of the values $y_n$ as samples of a function $y_n = y(x_n)$ where $x_n = x_0 + n\Delta x$ is a regular grid of points.
But what about when your grid is not uniform?
That is, what if you want to compute this result:
$$
Y_k^\pm = \sum_{j=1}^N y(x_j) e^{\pm i k x_j}
$$
where $y(x)$ is evaluated at an arbitrary set of points $x_j$?
In this case, the FFT is no longer directly applicable, and you're stuck using a much slower $O[N^2]$ direct summation.</p>
<p>Stuck, that is, until the NUFFT came along.</p>
<p>The NUFFT is an algorithm which converts the non-uniform transform into an approximate uniform transform, not with error-prone interpolation, but instead using a clever "gridding" operation motivated by the convolution theorem.
If you'd like to read about the algorithm in detail, the Courant Institute's <a href="http://www.cims.nyu.edu/cmcl/nufft/nufft.html">NUFFT page</a> has a nice set of resources.</p>
<p>Below we'll take a look at implementing this algorithm in Python.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Direct-Non-Uniform-Fourier-Transform">Direct Non-Uniform Fourier Transform<a class="anchor-link" href="#Direct-Non-Uniform-Fourier-Transform">&#182;</a></h2><p>When developing optimized code, it is important to start with something easy to make sure you're on the right track.
Here we'll start with a straightforward direct version of the non-uniform Fourier transform.
We'll allow non-uniform inputs $x_j$, but compute the output on a grid of $M$ evenly-spaced frequencies in the range $-M/2 \le f/\delta f &lt; M/2$.
This is what the NUFFT group calls the <em>Type-1 NUFFT</em>.</p>
<p>First we'll implement <code>nufftfreqs()</code>, which returns the frequency grid for a given $M$, and <code>nudft()</code> which computes the non-uniform discrete Fourier transform using a slow direct method. The arguments for the latter include <code>iflag</code>, which is a positive or negative number indicating the desired sign of the exponent:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[1]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span><span class="p">,</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">nufftfreqs</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute the frequency range used in nufft for M frequency bins&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">df</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">M</span> <span class="o">//</span> <span class="mi">2</span><span class="p">),</span> <span class="n">M</span> <span class="o">-</span> <span class="p">(</span><span class="n">M</span> <span class="o">//</span> <span class="mi">2</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">nudft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">iflag</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Non-Uniform Direct Fourier Transform&quot;&quot;&quot;</span>
    <span class="n">sign</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="k">if</span> <span class="n">iflag</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">sign</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">nufftfreqs</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Again, I can't emphasize this enough: when writing fast code, start with a slow-and-simple version of the code which you <em>know</em> gives the correct result, and then optimize from there.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Comparing-to-the-Fortran-NUFFT">Comparing to the Fortran NUFFT<a class="anchor-link" href="#Comparing-to-the-Fortran-NUFFT">&#182;</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can double-check that this is producing the desired result by comparing to the Fortran NUFFT implementation, using Python wrappers written by Dan Foreman-Mackey, available at <a href="http://github.com/dfm/python-nufft/">http://github.com/dfm/python-nufft/</a>:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[2]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Install nufft from http://github.com/dfm/python-nufft/</span>
<span class="kn">from</span> <span class="nn">nufft</span> <span class="k">import</span> <span class="n">nufft1</span> <span class="k">as</span> <span class="n">nufft_fortran</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">Y1</span> <span class="o">=</span> <span class="n">nudft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">nufft_fortran</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">Y1</span><span class="p">,</span> <span class="n">Y2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[2]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The results match! A quick check shows that, as we might expect, the Fortran algorithm is orders of magnitude faster:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[3]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">timeit</span> nudft(x, y, 1000)
<span class="o">%</span><span class="k">timeit</span> nufft_fortran(x, y, 1000)
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>10 loops, best of 3: 47.9 ms per loop
1000 loops, best of 3: 265 µs per loop
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>On top of this, for $N$ points and $N$ frequencies, the Fortran NUFFT will scale as $O[N\log N]$, while our simple implementation will scale as $O[N^2]$, making the difference even greater as $N$ increases! Let's see if we can do better.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NUFFT-with-Python">NUFFT with Python<a class="anchor-link" href="#NUFFT-with-Python">&#182;</a></h2><p>Here we'll attempt a pure-Python version of the fast, FFT-based NUFFT.
We'll follow the basics of the algorithm presented on the NUFFT page, using NumPy broadcasting tricks to push loops into the compiled layer of NumPy.
For later convenience, we'll start by defining a utility to compute the grid parameters as detailed in the NUFFT paper.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[4]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">_compute_grid_params</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="p">):</span>
    <span class="c1"># Choose Msp &amp; tau from eps following Dutt &amp; Rokhlin (1993)</span>
    <span class="k">if</span> <span class="n">eps</span> <span class="o">&lt;=</span> <span class="mf">1E-33</span> <span class="ow">or</span> <span class="n">eps</span> <span class="o">&gt;=</span> <span class="mf">1E-1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;eps = </span><span class="si">{0:.0e}</span><span class="s2">; must satisfy &quot;</span>
                         <span class="s2">&quot;1e-33 &lt; eps &lt; 1e-1.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eps</span><span class="p">))</span>
    <span class="n">ratio</span> <span class="o">=</span> <span class="mi">2</span> <span class="k">if</span> <span class="n">eps</span> <span class="o">&gt;</span> <span class="mf">1E-11</span> <span class="k">else</span> <span class="mi">3</span>
    <span class="n">Msp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">eps</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">ratio</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ratio</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">Mr</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">ratio</span> <span class="o">*</span> <span class="n">M</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Msp</span><span class="p">)</span>
    <span class="n">lambda_</span> <span class="o">=</span> <span class="n">Msp</span> <span class="o">/</span> <span class="p">(</span><span class="n">ratio</span> <span class="o">*</span> <span class="p">(</span><span class="n">ratio</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span>
    <span class="n">tau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">/</span> <span class="n">M</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">Msp</span><span class="p">,</span> <span class="n">Mr</span><span class="p">,</span> <span class="n">tau</span>


<span class="k">def</span> <span class="nf">nufft_python</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">,</span> <span class="n">iflag</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fast Non-Uniform Fourier Transform with Python&quot;&quot;&quot;</span>
    <span class="n">Msp</span><span class="p">,</span> <span class="n">Mr</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">_compute_grid_params</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Construct the convolved grid</span>
    <span class="n">ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Mr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">Mr</span> <span class="o">=</span> <span class="n">ftau</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">Mr</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">Msp</span><span class="p">,</span> <span class="n">Msp</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">xi</span> <span class="o">//</span> <span class="n">hx</span><span class="p">)</span>
        <span class="n">spread</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">hx</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">mm</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span>
        <span class="n">ftau</span><span class="p">[(</span><span class="n">m</span> <span class="o">+</span> <span class="n">mm</span><span class="p">)</span> <span class="o">%</span> <span class="n">Mr</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">spread</span>

    <span class="c1"># Compute the FFT on the convolved grid</span>
    <span class="k">if</span> <span class="n">iflag</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Ftau</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Mr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">ftau</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">ftau</span><span class="p">)</span>
    <span class="n">Ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">Ftau</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">M</span><span class="o">//</span><span class="mi">2</span><span class="p">):],</span> <span class="n">Ftau</span><span class="p">[:</span><span class="n">M</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]])</span>

    <span class="c1"># Deconvolve the grid using convolution theorem</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">nufftfreqs</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tau</span> <span class="o">*</span> <span class="n">k</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ftau</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's compare this to the previous results.
For convenience, we'll define a single routine which validates the results and times the execution:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[5]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">time</span>

<span class="k">def</span> <span class="nf">test_nufft</span><span class="p">(</span><span class="n">nufft_func</span><span class="p">,</span> <span class="n">M</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">Mtime</span><span class="o">=</span><span class="mi">100000</span><span class="p">):</span>
    <span class="c1"># Test vs the direct method</span>
    <span class="nb">print</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
    <span class="n">name</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;nufft1&#39;</span><span class="p">:</span><span class="s1">&#39;nufft_fortran&#39;</span><span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">nufft_func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                                          <span class="n">nufft_func</span><span class="o">.</span><span class="vm">__name__</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;testing </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
    <span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">M</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">iflag</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">F1</span> <span class="o">=</span> <span class="n">nudft</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">iflag</span><span class="o">=</span><span class="n">iflag</span><span class="p">)</span>
            <span class="n">F2</span> <span class="o">=</span> <span class="n">nufft_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span> <span class="n">iflag</span><span class="o">=</span><span class="n">iflag</span><span class="p">)</span>
            <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">F1</span><span class="p">,</span> <span class="n">F2</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Results match the DFT&quot;</span><span class="p">)</span>
    
    <span class="c1"># Time the nufft function</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">rng</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">Mtime</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">times</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">F</span> <span class="o">=</span> <span class="n">nufft_func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">Mtime</span><span class="p">)</span>
        <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
        <span class="n">times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t1</span> <span class="o">-</span> <span class="n">t0</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;- Execution time (M=</span><span class="si">{0}</span><span class="s2">): </span><span class="si">{1:.2g}</span><span class="s2"> sec&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">Mtime</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">times</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[6]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_python</span><span class="p">)</span>
<span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_fortran</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>------------------------------
testing nufft_python
- Results match the DFT
- Execution time (M=100000): 1.6 sec
------------------------------
testing nufft_fortran
- Results match the DFT
- Execution time (M=100000): 0.043 sec
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The good news is that our Python implementation works; the bad news is that it remains several orders of magnitude slower than the Fortran result!</p>
<p>Let's make it faster.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Making-Code-Faster:-Line-Profiling">Making Code Faster: Line Profiling<a class="anchor-link" href="#Making-Code-Faster:-Line-Profiling">&#182;</a></h3><p>We know that our Python function is slow, but we'd like to determine <em>where</em> this speed bottleneck lies.
One convenient way to do this is with the <code>line_profiler</code> utility, a Python/IPython addon which can be installed using</p>

<pre><code>$ pip install line_profiler</code></pre>
<p>Once it's installed, we can load the line profiler extension into the IPython notebook using the <code>%load_ext</code> magic function:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> line_profiler
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With the line profiler loaded, the <code>%lprun</code> magic function is now available, which we can use to profile our function line-by-line.
In order to display these results here, we'll save them to file and then use <code>%cat</code> to view the file.
The lines wrap in the notebook, making it difficult to read, so you may wish to <a href="http://jakevdp.github.io/downloads/notebooks/NUFFT_lpr.txt">view the raw file</a> instead.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[8]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">lprun</span> -s -f nufft_python -T lp_results.txt nufft_python(x, y, 1000)
<span class="o">%</span><span class="k">cat</span> lp_results.txt
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>
*** Profile printout saved to text file &#39;lp_results.txt&#39;. 
Timer unit: 1e-06 s

Total time: 0.040097 s
File: &lt;ipython-input-4-02aa33b61f03&gt;
Function: nufft_python at line 14

Line #      Hits         Time  Per Hit   % Time  Line Contents
==============================================================
    14                                           def nufft_python(x, c, M, df=1.0, eps=1E-15, iflag=1):
    15                                               &#34;&#34;&#34;Fast Non-Uniform Fourier Transform with Python&#34;&#34;&#34;
    16         1           41     41.0      0.1      Msp, Mr, tau = _compute_grid_params(M, eps)
    17         1            3      3.0      0.0      N = len(x)
    18                                           
    19                                               # Construct the convolved grid
    20         1           19     19.0      0.0      ftau = np.zeros(Mr, dtype=c.dtype)
    21         1            2      2.0      0.0      Mr = ftau.shape[0]
    22         1            3      3.0      0.0      hx = 2 * np.pi / Mr
    23         1           11     11.0      0.0      mm = np.arange(-Msp, Msp)
    24      1001         1493      1.5      3.7      for i in range(N):
    25      1000         2801      2.8      7.0          xi = (x[i] * df) % (2 * np.pi)
    26      1000         3024      3.0      7.5          m = 1 + int(xi // hx)
    27      1000        21048     21.0     52.5          spread = np.exp(-0.25 * (xi - hx * (m + mm)) ** 2 / tau)
    28      1000        11406     11.4     28.4          ftau[(m + mm) % Mr] += c[i] * spread
    29                                           
    30                                               # Compute the FFT on the convolved grid
    31         1            2      2.0      0.0      if iflag &lt; 0:
    32                                                   Ftau = (1 / Mr) * np.fft.fft(ftau)
    33                                               else:
    34         1          183    183.0      0.5          Ftau = np.fft.ifft(ftau)
    35         1           15     15.0      0.0      Ftau = np.concatenate([Ftau[-(M//2):], Ftau[:M//2 + M % 2]])
    36                                           
    37                                               # Deconvolve the grid using convolution theorem
    38         1           14     14.0      0.0      k = nufftfreqs(M)
    39         1           32     32.0      0.1      return (1 / N) * np.sqrt(np.pi / tau) * np.exp(tau * k ** 2) * Ftau</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The output shows us where, line-by-line, the algorithm is spending the most time.
We see that nearly 99% of the execution time is being spent in the single <code>for</code> loop at the center of our code.
The loop is so expensive that even the FFT computation is just a trivial piece of the cost!
This is actually pretty typical: due to dynamic typing, loops are generally very slow in Python.</p>
<p>One of the surest strategies for speeding-up your code is to use broadcasting tricks in NumPy to remove these kinds of large loops: you can read one of my course lectures on the subject <a href="http://nbviewer.ipython.org/url/www.astro.washington.edu/users/vanderplas/Astr599_2014/notebooks/11_EfficientNumpy.ipynb">here</a>.
We'll do this next.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="NUFFT-with-NumPy-Broadcasting">NUFFT with NumPy Broadcasting<a class="anchor-link" href="#NUFFT-with-NumPy-Broadcasting">&#182;</a></h2><p>Let's rewrite the above implementation and use broadcasting tricks to elliminate the loops.
Because of the structure of this problem, the approach is a bit complicated here, but it turns out that we can take advantage here of the little-known <code>at()</code> method of NumPy's ufunc (available since NumPy 1.8).
Briefly,</p>

<pre><code>&gt;&gt;&gt; np.add.at(x, i, y)</code></pre>
<p>is similar to</p>

<pre><code>&gt;&gt;&gt; x[i] += y</code></pre>
<p>but works as desired even if the incides <code>i</code> have duplicate entries.</p>
<p>Using this, we can adjust our implementation as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[9]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">nufft_numpy</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">iflag</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fast Non-Uniform Fourier Transform&quot;&quot;&quot;</span>
    <span class="n">Msp</span><span class="p">,</span> <span class="n">Mr</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">_compute_grid_params</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Construct the convolved grid ftau:</span>
    <span class="c1"># this replaces the loop used above</span>
    <span class="n">ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Mr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">hx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">Mr</span>
    <span class="n">xmod</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">df</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">xmod</span> <span class="o">//</span> <span class="n">hx</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">mm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">Msp</span><span class="p">,</span> <span class="n">Msp</span><span class="p">)</span>
    <span class="n">mpmm</span> <span class="o">=</span> <span class="n">m</span> <span class="o">+</span> <span class="n">mm</span><span class="p">[:,</span> <span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span>
    <span class="n">spread</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">xmod</span> <span class="o">-</span> <span class="n">hx</span> <span class="o">*</span> <span class="n">mpmm</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span>
    <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="o">.</span><span class="n">at</span><span class="p">(</span><span class="n">ftau</span><span class="p">,</span> <span class="n">mpmm</span> <span class="o">%</span> <span class="n">Mr</span><span class="p">,</span> <span class="n">spread</span><span class="p">)</span>

    <span class="c1"># Compute the FFT on the convolved grid</span>
    <span class="k">if</span> <span class="n">iflag</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Ftau</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Mr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">ftau</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">ftau</span><span class="p">)</span>
    <span class="n">Ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">Ftau</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">M</span><span class="o">//</span><span class="mi">2</span><span class="p">):],</span> <span class="n">Ftau</span><span class="p">[:</span><span class="n">M</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]])</span>

    <span class="c1"># Deconvolve the grid using convolution theorem</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">nufftfreqs</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tau</span> <span class="o">*</span> <span class="n">k</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ftau</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's test it:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_numpy</span><span class="p">)</span>
<span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_python</span><span class="p">)</span>
<span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_fortran</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>------------------------------
testing nufft_numpy
- Results match the DFT
- Execution time (M=100000): 0.45 sec
------------------------------
testing nufft_python
- Results match the DFT
- Execution time (M=100000): 1.6 sec
------------------------------
testing nufft_fortran
- Results match the DFT
- Execution time (M=100000): 0.044 sec
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It worked! We gained around a factor of 4 speedup in replacing the Python loop with the <code>np.add.at()</code> call.
Still, though, we're sitting at about a factor of 10 slower than the Fortran version.
The problem is that the <code>np.add.at()</code> call here requires construction of some very large and costly temporary arrays.
If we want a faster execution time, we need to further optimize that main loop, and we can't do this with NumPy alone.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Optimization-with-Numba">Optimization with Numba<a class="anchor-link" href="#Optimization-with-Numba">&#182;</a></h2><p>When NumPy broadcasting tricks aren't enough, there are a few options: you can write Fortran or C code directly, you can use <a href="http://cython.org">Cython</a>, <a href="http://docs.scipy.org/doc/scipy/reference/tutorial/weave.html">Weave</a>, or other tools as a bridge to include compiled snippets in your script, or you can use a tool like <a href="http://cython.org">Numba</a> to speed-up your loops without ever leaving Python.</p>
<p>Numba is a slick tool which runs Python functions through an LLVM just-in-time (JIT) compiler, leading to orders-of-magnitude faster code for certain operations.
In this case, we need to optimize what amounts to a nested for-loop, so Numba fits the bill perfectly.
For clarity, we'll pull-out the grid construction code that we want to optimize, and write it as follows:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numba</span>

<span class="c1"># nopython=True means an error will be raised</span>
<span class="c1"># if fast compilation is not possible.</span>
<span class="nd">@numba</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">build_grid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Msp</span><span class="p">,</span> <span class="n">ftau</span><span class="p">):</span>
    <span class="n">Mr</span> <span class="o">=</span> <span class="n">ftau</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">Mr</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">xi</span> <span class="o">//</span> <span class="n">hx</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">Msp</span><span class="p">,</span> <span class="n">Msp</span><span class="p">):</span>
            <span class="n">ftau</span><span class="p">[(</span><span class="n">m</span> <span class="o">+</span> <span class="n">mm</span><span class="p">)</span> <span class="o">%</span> <span class="n">Mr</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">hx</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">mm</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ftau</span>


<span class="k">def</span> <span class="nf">nufft_numba</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">,</span> <span class="n">iflag</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fast Non-Uniform Fourier Transform with Numba&quot;&quot;&quot;</span>
    <span class="n">Msp</span><span class="p">,</span> <span class="n">Mr</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">_compute_grid_params</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Construct the convolved grid</span>
    <span class="n">ftau</span> <span class="o">=</span> <span class="n">build_grid</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">df</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Msp</span><span class="p">,</span>
                      <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Mr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

    <span class="c1"># Compute the FFT on the convolved grid</span>
    <span class="k">if</span> <span class="n">iflag</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Ftau</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Mr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">ftau</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">ftau</span><span class="p">)</span>
    <span class="n">Ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">Ftau</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">M</span><span class="o">//</span><span class="mi">2</span><span class="p">):],</span> <span class="n">Ftau</span><span class="p">[:</span><span class="n">M</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]])</span>

    <span class="c1"># Deconvolve the grid using convolution theorem</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">nufftfreqs</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tau</span> <span class="o">*</span> <span class="n">k</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ftau</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's test this now:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[12]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_numba</span><span class="p">)</span>
<span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_fortran</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>------------------------------
testing nufft_numba
- Results match the DFT
- Execution time (M=100000): 0.1 sec
------------------------------
testing nufft_fortran
- Results match the DFT
- Execution time (M=100000): 0.046 sec
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Much better! We're now within about a factor of 3 of the Fortran speed, and we're still writing pure Python!</p>
<p>Having plucked all the low-hanging fruit, any further optimization will now be very low-level: that is, thinking about things like reduction of the number of <code>exp()</code> evaluations through application of mathematical identities.
This type of careful logic is one reason the Fortran implementation is so fast, and many of these low-level strategies are discussed in the NUFFT paper linked above.</p>
<p>To gain some more speed, we can follow their advice and optimize the expressions at this level by precomputing expensive expressions and recombining these expressions later:
This obfuscates the logic of the algorithm a bit, but it does lead to some faster execution.
Here is an example of this:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[13]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numba</span>

<span class="nd">@numba</span><span class="o">.</span><span class="n">jit</span><span class="p">(</span><span class="n">nopython</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">build_grid_fast</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Msp</span><span class="p">,</span> <span class="n">ftau</span><span class="p">,</span> <span class="n">E3</span><span class="p">):</span>
    <span class="n">Mr</span> <span class="o">=</span> <span class="n">ftau</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">hx</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">Mr</span>
    
    <span class="c1"># precompute some exponents</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Msp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">E3</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">j</span> <span class="o">/</span> <span class="n">Mr</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span>
        
    <span class="c1"># spread values onto ftau</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">xi</span> <span class="o">//</span> <span class="n">hx</span><span class="p">)</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="n">hx</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">E1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.25</span> <span class="o">*</span> <span class="n">xi</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span>
        <span class="n">E2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">xi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">Mr</span> <span class="o">*</span> <span class="n">tau</span><span class="p">))</span>
        <span class="n">E2mm</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">for</span> <span class="n">mm</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Msp</span><span class="p">):</span>
            <span class="n">ftau</span><span class="p">[(</span><span class="n">m</span> <span class="o">+</span> <span class="n">mm</span><span class="p">)</span> <span class="o">%</span> <span class="n">Mr</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">E1</span> <span class="o">*</span> <span class="n">E2mm</span> <span class="o">*</span> <span class="n">E3</span><span class="p">[</span><span class="n">mm</span><span class="p">]</span>
            <span class="n">E2mm</span> <span class="o">*=</span> <span class="n">E2</span>
            <span class="n">ftau</span><span class="p">[(</span><span class="n">m</span> <span class="o">-</span> <span class="n">mm</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">Mr</span><span class="p">]</span> <span class="o">+=</span> <span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">E1</span> <span class="o">/</span> <span class="n">E2mm</span> <span class="o">*</span> <span class="n">E3</span><span class="p">[</span><span class="n">mm</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">ftau</span>


<span class="k">def</span> <span class="nf">nufft_numba_fast</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">df</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1E-15</span><span class="p">,</span> <span class="n">iflag</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Fast Non-Uniform Fourier Transform with Numba&quot;&quot;&quot;</span>
    <span class="n">Msp</span><span class="p">,</span> <span class="n">Mr</span><span class="p">,</span> <span class="n">tau</span> <span class="o">=</span> <span class="n">_compute_grid_params</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Construct the convolved grid</span>
    <span class="n">ftau</span> <span class="o">=</span> <span class="n">build_grid_fast</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">df</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">Msp</span><span class="p">,</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Mr</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">c</span><span class="o">.</span><span class="n">dtype</span><span class="p">),</span>
                           <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Msp</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">))</span>

    <span class="c1"># Compute the FFT on the convolved grid</span>
    <span class="k">if</span> <span class="n">iflag</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">Ftau</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">Mr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">ftau</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">Ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">ftau</span><span class="p">)</span>
    <span class="n">Ftau</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">Ftau</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">M</span><span class="o">//</span><span class="mi">2</span><span class="p">):],</span> <span class="n">Ftau</span><span class="p">[:</span><span class="n">M</span><span class="o">//</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M</span> <span class="o">%</span> <span class="mi">2</span><span class="p">]])</span>

    <span class="c1"># Deconvolve the grid using convolution theorem</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">nufftfreqs</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">tau</span> <span class="o">*</span> <span class="n">k</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">Ftau</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's test the result:</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[14]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_numba_fast</span><span class="p">)</span>
<span class="n">test_nufft</span><span class="p">(</span><span class="n">nufft_fortran</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>------------------------------
testing nufft_numba_fast
- Results match the DFT
- Execution time (M=100000): 0.06 sec
------------------------------
testing nufft_fortran
- Results match the DFT
- Execution time (M=100000): 0.047 sec
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This is looking good! With a bit of effort we are now within about 25% of the Fortran speed, and we retain all the advantages of having pure Python code!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Final-Timing-Comparison">Final Timing Comparison<a class="anchor-link" href="#Final-Timing-Comparison">&#182;</a></h2><p>For good measure, let's take a look at the scaling with $M$ for all the fast algorithms we created.
We'll compute the times for a range of input sizes for each algorithm.
Be aware that the following code will take several minutes to run!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># use seaborn for nice default plot settings</span>
<span class="kn">import</span> <span class="nn">seaborn</span><span class="p">;</span> <span class="n">seaborn</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Mrange</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span> <span class="o">**</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">18</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>

<span class="n">t_python</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">t_numpy</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">t_numba</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">t_numba_fast</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">t_fortran</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">M</span> <span class="ow">in</span> <span class="n">Mrange</span><span class="p">:</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    
    <span class="n">t1</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span> -oq nufft_python(x, c, M)
    <span class="n">t2</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span> -oq nufft_numpy(x, c, M)
    <span class="n">t3</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span> -oq nufft_numba(x, c, M)
    <span class="n">t4</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span> -oq nufft_numba_fast(x, c, M)
    <span class="n">t5</span> <span class="o">=</span> <span class="o">%</span><span class="k">timeit</span> -oq nufft_fortran(x, c, M)
    
    <span class="n">t_python</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t1</span><span class="o">.</span><span class="n">best</span><span class="p">)</span>
    <span class="n">t_numpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t2</span><span class="o">.</span><span class="n">best</span><span class="p">)</span>
    <span class="n">t_numba</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t3</span><span class="o">.</span><span class="n">best</span><span class="p">)</span>
    <span class="n">t_numba_fast</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t4</span><span class="o">.</span><span class="n">best</span><span class="p">)</span>
    <span class="n">t_fortran</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t5</span><span class="o">.</span><span class="n">best</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[17]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Mrange</span><span class="p">,</span> <span class="n">t_python</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Mrange</span><span class="p">,</span> <span class="n">t_numpy</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Mrange</span><span class="p">,</span> <span class="n">t_numba</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;numba #1&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Mrange</span><span class="p">,</span> <span class="n">t_numba_fast</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;numba #2&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">loglog</span><span class="p">(</span><span class="n">Mrange</span><span class="p">,</span> <span class="n">t_fortran</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;fortran&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Number of Elements&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Execution Time (s)&#39;</span><span class="p">);</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>




<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
TzywRwAAAABJRU5ErkJggg==
"
>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As we see, all the algorithms scale as $\sim O[N\log N]$ in the large $N$ limit, albeit with very different constants of proportionality.
Our final optimized Numba implementation nearly matches the Fortran version as $N$ grows large, and because it is written in pure Python, it retains all the advantages of pure Python code listed above.
For that benefit, I think the cost of a ~25% slow-down is well worth it!</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conclusion">Conclusion<a class="anchor-link" href="#Conclusion">&#182;</a></h2><p>I hope you've enjoyed this exploration of how to write fast numerical code in pure Python.
As you think about writing efficient implementations of useful algorithms, I invite you to consider the points I listed above: in particular, how difficult will it be for your users to install, read, modify, and contribute to your code?
In the long run, this may be much more important than shaving a few milliseconds off the execution time.
Writing a fast implementation of a useful algorithm is an excellent and useful pursuit, but we should be careful to not forget the costs that come along with such optimization.</p>
<p>If you're interested in using the pure-Python NUFFT implementation, I've adapted much of the above code in a repository at <a href="http://github.com/jakevdp/nufftpy/">http://github.com/jakevdp/nufftpy/</a>.
It contains a packaged and unit-tested version of some of the above code, as well as a (hopefully) growing compendium of related routines.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><em>This post was written entirely in the IPython notebook.  You can
<a href="http://jakevdp.github.io/downloads/notebooks/NUFFT.ipynb">download</a>
this notebook, or see a static view
<a href="http://nbviewer.ipython.org/url/jakevdp.github.io/downloads/notebooks/NUFFT.ipynb">here</a>.</em></p>

</div>
</div>
</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </div>

        <div class="meta">
            <div>
                    <a href="/tag/numpy.html" class="tag">numpy</a>
                    <a href="/tag/numba.html" class="tag">numba</a>
            </div>
        </div>
    </article>


</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
    margin: .2em 0.4em;
    max-width: 580px;
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>
<!--
    <footer>
      <p>
        © 2012-2017 Rodrigo Theodoro, license <a href="https://github.com/jakevdp/jakevdp.github.io-source/blob/master/LICENSE"> </a>
        unless otherwise noted.
        Generated by <a href= "http://docs.getpelican.com/">Pelican</a>.
      </p>
    </footer>
-->
    </body>
</html>