<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="author" content="Rodrigo Theodoro">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width">
        <title>Lempel-Ziv | </title>

	<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
	<link rel="icon" href="/favicon.ico" type="image/x-icon">
        <link rel="alternate" type="application/atom+xml" title=" blog atom feed" href="/feeds/all.atom.xml" />
        <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
        <link rel="stylesheet" type="text/css" href="/theme/css/icons.css"/>
        <style>.highlight .hll { background-color: #ffffcc }
.highlight .c { color: #60a0b0; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #007020; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .cm { color: #60a0b0; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #007020 } /* Comment.Preproc */
.highlight .c1 { color: #60a0b0; font-style: italic } /* Comment.Single */
.highlight .cs { color: #60a0b0; background-color: #fff0f0 } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #808080 } /* Generic.Output */
.highlight .gp { color: #c65d09; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0040D0 } /* Generic.Traceback */
.highlight .kc { color: #007020; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #007020; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #007020; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #007020 } /* Keyword.Pseudo */
.highlight .kr { color: #007020; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #902000 } /* Keyword.Type */
.highlight .m { color: #40a070 } /* Literal.Number */
.highlight .s { color: #4070a0 } /* Literal.String */
.highlight .na { color: #4070a0 } /* Name.Attribute */
.highlight .nb { color: #007020 } /* Name.Builtin */
.highlight .nc { color: #0e84b5; font-weight: bold } /* Name.Class */
.highlight .no { color: #60add5 } /* Name.Constant */
.highlight .nd { color: #555555; font-weight: bold } /* Name.Decorator */
.highlight .ni { color: #d55537; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #007020 } /* Name.Exception */
.highlight .nf { color: #06287e } /* Name.Function */
.highlight .nl { color: #002070; font-weight: bold } /* Name.Label */
.highlight .nn { color: #0e84b5; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #062873; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #bb60d5 } /* Name.Variable */
.highlight .ow { color: #007020; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mf { color: #40a070 } /* Literal.Number.Float */
.highlight .mh { color: #40a070 } /* Literal.Number.Hex */
.highlight .mi { color: #40a070 } /* Literal.Number.Integer */
.highlight .mo { color: #40a070 } /* Literal.Number.Oct */
.highlight .sb { color: #4070a0 } /* Literal.String.Backtick */
.highlight .sc { color: #4070a0 } /* Literal.String.Char */
.highlight .sd { color: #4070a0; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #4070a0 } /* Literal.String.Double */
.highlight .se { color: #4070a0; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #4070a0 } /* Literal.String.Heredoc */
.highlight .si { color: #70a0d0; font-style: italic } /* Literal.String.Interpol */
.highlight .sx { color: #c65d09 } /* Literal.String.Other */
.highlight .sr { color: #235388 } /* Literal.String.Regex */
.highlight .s1 { color: #4070a0 } /* Literal.String.Single */
.highlight .ss { color: #517918 } /* Literal.String.Symbol */
.highlight .bp { color: #007020 } /* Name.Builtin.Pseudo */
.highlight .vc { color: #bb60d5 } /* Name.Variable.Class */
.highlight .vg { color: #bb60d5 } /* Name.Variable.Global */
.highlight .vi { color: #bb60d5 } /* Name.Variable.Instance */
.highlight .il { color: #40a070 } /* Literal.Number.Integer.Long */</style>
        <style>body {
  margin: 0;
  padding: 0;
  font: 15px 'Source Sans Pro', sans-serif;
  line-height: 1.6em;
  color: #222;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
}
a {
  color: #007EE5;
  text-decoration: none;
}
a:hover {
  color: #007EE5;
  text-decoration: none;
}
header.main-header {
  background: none repeat scroll 0% 0% #205F29;
  margin-bottom: 0px;
}
header.main-header a {
  color: #fff;
}
header.main-header .container {
  max-width: 1000px;
}
header.main-header .container nav a:hover {
  background-color: #5C881C;
}
article {
  margin: 0;
}
article header.about {
  margin-bottom: 0px;
  padding-bottom: 0px;
}
article header {
  margin-bottom: 20px;
  padding-bottom: 20px;
}
article header h1 {
  margin-bottom: 2px;
  font-weight: 700;
  color: #000;
}
article header time {
  color: #9E9E9E;
  font-size: 0.85em;
  float: right;
}
article header time.left {
  color: #9E9E9E;
  font-size: 0.85em;
  float: left;
}
article div.social-links ul {
  padding: 0px;
}
article div.social-links li {
  display: inline;
  font-size: 20px;
}
article div.social-links li a {
  color: #000;
  padding: 10px;
}
article div.social-links li a:hover {
  color: #666;
  text-decoration: none;
}
article p {
  font-size: 16px;
  margin-bottom: 20px;
  line-height: 1.6em;
}
article p.note {
  background: #f5f5f5;
  border: 1px solid #ddd;
  padding: 0.533em 0.733em;
}
article p.update {
  background-color: #FEEFB3;
  border: 1px solid #e6e68a;
  padding: 0.533em 0.733em;
}
article p.alert {
  background-color: #ffe2e2;
  border: 1px solid #ffb2b2;
  padding: 0.533em 0.733em;
}
article ul,
article ol {
  margin-top: 0px;
  margin-bottom: 25px;
}
article li {
  font-size: 16px;
  line-height: 1.6em;
}
article a:hover {
  text-decoration: underline;
}
article blockquote {
  border-left: 2px solid #c7c7cc;
  color: #666;
  margin: 30px 0;
  padding: 0 0 0 25px;
}
article img {
  max-width: 100%;
}
article code {
  color: #333;
  background-color: #EEE;
  border-radius: 0;
  font-size: 13px;
}
article .meta {
  font-size: 11px;
}
article .meta a:hover {
  text-decoration: none;
}
article .meta div {
  margin-bottom: 20px;
  display: block;
}
article .meta a.tag {
  margin: 0 10px 10px 0;
  padding: 1px 12px;
  display: inline-block;
  font-size: 14px;
  color: rgba(0, 0, 0, 0.8);
  background: rgba(0, 0, 0, 0.05);
}
article .meta a.tag:hover {
  background: rgba(0, 0, 0, 0.15);
}
article .meta a.read_more,
article .meta a.comments_btn {
  font-size: 14px;
  font-weight: 800;
  padding: 10px 20px;
  color: #205F29;
  background: #FFF;
  border: 1px solid #205F29;
}
article .meta a.read_more:hover,
article .meta a.comments_btn:hover {
  color: #FFF;
  background: #5C881C;
}
.index {
  max-width: 700px;
}
.index article header h2 {
  font-size: 36px;
  margin-bottom: 2px;
  font-weight: 700;
}
.index article header h2 a {
  color: #000;
}
.index article header h2 a:hover {
  color: #007EE5;
  text-decoration: none;
}
.index .separator {
  padding: 40px 0 0 0;
  margin: 0 0 40px 0;
  height: 10px;
  border-bottom: solid 1px #CCC;
}
.index .pagination {
  display: block;
  margin-bottom: 100px;
}
.index .pagination .left {
  text-align: right;
}
.index .pagination .right {
  text-align: left;
}
.index .pagination a {
  display: inline-block;
  border: 2px solid #5C881C;
  margin: 0 5px;
  padding: 8px 20px;
  font-weight: bold;
  color: #5C881C;
}
.index .pagination a:hover {
  color: #FFF;
  background: #5C881C;
}
.post {
  max-width: 700px;
}
.post h2:before {
  content: "# ";
  font-weight: bold;
  color: #DDD;
}
.post h3:before {
  content: "## ";
  font-weight: bold;
  color: #DDD;
}
.post h4:before {
  content: "### ";
  font-weight: bold;
  color: #DDD;
}
.post article .meta {
  margin: 50px 0 100px;
}
.list {
  max-width: 700px;
}
.list ul.double-list {
  margin: 0 auto 60px;
  padding: 0;
  list-style-type: none;
}
.list ul.double-list li {
  padding: 5px 0;
}
.list ul.double-list li h2 {
  font-size: 1em;
  display: inline;
  font-weight: normal;
}
.list ul.double-list li span {
  font-family: sans-serif;
  text-transform: uppercase;
  text-align: right;
  float: right;
  padding-top: 3px;
  font-size: 12px;
  color: #999;
}
.full-width-content {
  padding-top: 10px;
  padding-left: 0px;
  padding-right: 0px;
  margin-left: -20px;
  margin-right: -20px;
}
.col-xs-1,
.col-sm-1,
.col-md-1,
.col-lg-1,
.col-xs-2,
.col-sm-2,
.col-md-2,
.col-lg-2,
.col-xs-3,
.col-sm-3,
.col-md-3,
.col-lg-3,
.col-xs-4,
.col-sm-4,
.col-md-4,
.col-lg-4,
.col-xs-5,
.col-sm-5,
.col-md-5,
.col-lg-5,
.col-xs-6,
.col-sm-6,
.col-md-6,
.col-lg-6,
.col-xs-7,
.col-sm-7,
.col-md-7,
.col-lg-7,
.col-xs-8,
.col-sm-8,
.col-md-8,
.col-lg-8,
.col-xs-9,
.col-sm-9,
.col-md-9,
.col-lg-9,
.col-xs-10,
.col-sm-10,
.col-md-10,
.col-lg-10,
.col-xs-11,
.col-sm-11,
.col-md-11,
.col-lg-11,
.col-xs-12,
.col-sm-12,
.col-md-12,
.col-lg-12 {
  padding-right: 0px;
  padding-left: 0px;
}</style>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML" type="text/javascript"></script>
        <script type="text/javascript">
        init_mathjax = function() {
            if (window.MathJax) {
                // MathJax loaded
                MathJax.Hub.Config({
                    tex2jax: {
                        inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                        displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
                    },
                    displayAlign: 'left', // Change this to 'center' to center equations.
                    "HTML-CSS": {
                        styles: {'.MathJax_Display': {"margin": 0}}
                    }
                });
                MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
            }
        }
        init_mathjax();
        </script>

    </head>

    <body>
        <header class="navbar navbar-inverse bs-docs-nav">
            <div class="container-fluid">
                <div class="navbar-header">
		  <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#theNavbar">
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span>
		    <span class="icon-bar"></span> 
		  </button>
                  <a class="navbar-brand" href="/" title="Home" class="title"></a>
                </div>
                <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation" id="theNavbar">
		    <ul class="nav navbar-nav navbar-right">
                            <li><a href="/pages/about.html" title="About">About</a></li>
                            <li><a href="/archives.html" title="Archive">Archive</a></li>
                    </ul>
                </nav>
            </div>
        </header>

        <div id="wrap">
<div class="container post">
    <article>
        <header>
            <h1>Lempel-Ziv</h1>
            <time datetime="article.date.isoformat()" pubdate>Mon 14 October 2019</time>
        </header>

        <div class="article_content">
            <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="LZ78">LZ78<a class="anchor-link" href="#LZ78">&#182;</a></h1><p>The lempel-zip compression algorithm proposed in 1978, also called LZ78, processes a text $T[1,n]$ from left to right and cuts it into $z$ substrings, called <em>phrases</em>. Navarro, in Compact Data Structures book, defined the algorithm in plain english in a simple way:</p>
<blockquote><p>"As the text is parsed, each new phrase is extended as much as possible to the right as long as it matches <strong>some previous phrase</strong>, and then next the new character (the mismatched one) is also included."</p>
</blockquote>
<p>This whole process is called the parsing of $T$. A trie is a data structure that can be used to store the parsing results. Basically, a trie is a tree that holds every suffix of a word/text. To spell the suffix from a trie, we traverse it from the root to a leaf outputting the label in the edges found in the path. A trie is usefull in string matching because when comparing a word of size $m$ with a text of size $n$ in the "brute force" way we must perform $m*n$ comparisons, while with the aid of the trie the number of comparisons is the size of the word to be mathed ($m$). If you want to learn more about tries in the context of string matching watch the excelent lecture from Ben Langmead. In fact, I'll use his code as base to the LZ78 python implementation parser.</p>
<p>Be aware that the trie used in LZ78 implementation will not hold every suffix but a phrase for each path begining at a root and ending at a leaf.</p>
<p>The example 8.28 from Navarro`s CDS is reproduced bellow to show the LZ78 parsing of the text  how_can_a_clam_cram_in_a_clean_cream_can. The parsing is carried out as follows.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[10]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">LZ78Trie</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">+=</span> <span class="s1">&#39;$&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
      <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
      <span class="n">j</span> <span class="o">=</span> <span class="mi">1</span>
      <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">:]:</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">:</span>
          <span class="n">cur</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
          <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
          <span class="k">break</span>
        <span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
        <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        

  <span class="k">def</span> <span class="nf">followPath</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cur</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
      <span class="n">cur</span> <span class="o">=</span> <span class="n">cur</span><span class="p">[</span><span class="n">c</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">cur</span>
  
  
  <span class="k">def</span> <span class="nf">has_substring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Return true if s appears as a substring of t &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">follow_path</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
  
  
  <span class="k">def</span> <span class="nf">to_dot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Return dot representation of trie to make a picture &quot;&quot;&quot;</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">_to_dot_helper</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">parid</span><span class="p">):</span>
        <span class="n">childid</span> <span class="o">=</span> <span class="n">parid</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%d</span><span class="s1"> -&gt; </span><span class="si">%d</span><span class="s1"> [ label=&quot;</span><span class="si">%s</span><span class="s1">&quot; ];&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">parid</span><span class="p">,</span> <span class="n">childid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">))</span>
            <span class="n">childid</span> <span class="o">=</span> <span class="n">_to_dot_helper</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">childid</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">childid</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;digraph &quot;Suffix trie&quot; {&#39;</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  node [shape=circle label=&quot;&quot;];&#39;</span><span class="p">)</span>
    <span class="n">_to_dot_helper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> wget https://raw.github.com/cjdrake/ipython-magic/master/gvmagic.py
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>--2019-10-14 15:37:09--  https://raw.github.com/cjdrake/ipython-magic/master/gvmagic.py
Resolving raw.github.com... 151.101.92.133
Connecting to raw.github.com|151.101.92.133|:443... connected.
HTTP request sent, awaiting response... 301 Moved Permanently
Location: https://raw.githubusercontent.com/cjdrake/ipython-magic/master/gvmagic.py [following]
--2019-10-14 15:37:09--  https://raw.githubusercontent.com/cjdrake/ipython-magic/master/gvmagic.py
Resolving raw.githubusercontent.com... 151.101.92.133
Connecting to raw.githubusercontent.com|151.101.92.133|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 4988 (4.9K) [text/plain]
Saving to: ‘gvmagic.py.2’

gvmagic.py.2        100%[===================&gt;]   4.87K  --.-KB/s    in 0.001s  

2019-10-14 15:37:10 (5.27 MB/s) - ‘gvmagic.py.2’ saved [4988/4988]

</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[18]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> gvmagic
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>The gvmagic extension is already loaded. To reload it, use:
  %reload_ext gvmagic
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[19]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">dotstr</span> LZ78Trie(&quot;how_can_a_clam_cram_in_a_clean_cream_can&quot;).to_dot()
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+CjwhRE9DVFlQRSBzdmcgUFVCTElDICItLy9XM0MvL0RURCBTVkcgMS4xLy9FTiIKICJodHRwOi8vd3d3LnczLm9yZy9HcmFwaGljcy9TVkcvMS4xL0RURC9zdmcxMS5kdGQiPgo8IS0tIEdlbmVyYXRlZCBieSBncmFwaHZpeiB2ZXJzaW9uIDIuNDAuMSAoMjAxNjEyMjUuMDMwNCkKIC0tPgo8IS0tIFRpdGxlOiBTdWZmaXggdHJpZSBQYWdlczogMSAtLT4KPHN2ZyB3aWR0aD0iNTg0cHQiIGhlaWdodD0iMzg4cHQiCiB2aWV3Qm94PSIwLjAwIDAuMDAgNTg0LjAwIDM4OC4wMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CjxnIGlkPSJncmFwaDAiIGNsYXNzPSJncmFwaCIgdHJhbnNmb3JtPSJzY2FsZSgxIDEpIHJvdGF0ZSgwKSB0cmFuc2xhdGUoNCAzODQpIj4KPHRpdGxlPlN1ZmZpeCB0cmllPC90aXRsZT4KPHBvbHlnb24gZmlsbD0iI2ZmZmZmZiIgc3Ryb2tlPSJ0cmFuc3BhcmVudCIgcG9pbnRzPSItNCw0IC00LC0zODQgNTgwLC0zODQgNTgwLDQgLTQsNCIvPgo8IS0tIDAgLS0+CjxnIGlkPSJub2RlMSIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+MDwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjMyNyIgY3k9Ii0zNjIiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSAxIC0tPgo8ZyBpZD0ibm9kZTIiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjE8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGN4PSI3MiIgY3k9Ii0yNzYiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSAwJiM0NTsmZ3Q7MSAtLT4KPGcgaWQ9ImVkZ2UxIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT4wJiM0NTsmZ3Q7MTwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTMwOS4wMDEsLTM1OC45NjgzQzI2OS4zNDAzLC0zNTEuNzk5IDE3Mi4xMzU5LC0zMzEuNTIyMiA5OSwtMjk0IDk3Ljg0NCwtMjkzLjQwNjkgOTYuNjc3MiwtMjkyLjc3NDYgOTUuNTEwOCwtMjkyLjExNSIvPgo8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50cz0iOTcuMTE1OCwtMjg4Ljk5MjcgODYuNzY3NiwtMjg2LjcyMDEgOTMuNDQsLTI5NC45NDk5IDk3LjExNTgsLTI4OC45OTI3Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjE3NS41IiB5PSItMzE0LjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCIgZmlsbD0iIzAwMDAwMCI+XzwvdGV4dD4KPC9nPgo8IS0tIDYgLS0+CjxnIGlkPSJub2RlNyIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+NjwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjEyNiIgY3k9Ii0yNzYiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSAwJiM0NTsmZ3Q7NiAtLT4KPGcgaWQ9ImVkZ2U2IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT4wJiM0NTsmZ3Q7NjwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTMwOS42MDcsLTM1Ni43MjgzQzI3Ny41OTMxLC0zNDYuNjk3MSAyMDcuNjE2NiwtMzIzLjIzMjIgMTUzLC0yOTQgMTUxLjg1NDUsLTI5My4zODY5IDE1MC42OTYyLC0yOTIuNzM4MiAxNDkuNTM2OSwtMjkyLjA2NTIiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjE1MS4xNTUyLC0yODguOTQ5NSAxNDAuODE5MywtMjg2LjYyMTUgMTQ3LjQ0NzUsLTI5NC44ODY5IDE1MS4xNTUyLC0yODguOTQ5NSIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIyMjYuMTA2OSIgeT0iLTMxNC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiIGZpbGw9IiMwMDAwMDAiPmU8L3RleHQ+CjwvZz4KPCEtLSA3IC0tPgo8ZyBpZD0ibm9kZTgiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjc8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGN4PSIxODAiIGN5PSItMjc2IiByeD0iMTgiIHJ5PSIxOCIvPgo8L2c+CjwhLS0gMCYjNDU7Jmd0OzcgLS0+CjxnIGlkPSJlZGdlNyIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+MCYjNDU7Jmd0Ozc8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGQ9Ik0zMTAuODY4NywtMzUzLjM0MzJDMjg3LjYyNywtMzQwLjc2MiAyNDMuNTAxOCwtMzE2LjQ2ODcgMjA3LC0yOTQgMjA1Ljg5MzYsLTI5My4zMTg5IDIwNC43NjczLC0yOTIuNjE0NSAyMDMuNjMzOSwtMjkxLjg5NjQiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjIwNS4zMDI2LC0yODguODA2NSAxOTUuMDExOCwtMjg2LjI4NjUgMjAxLjQ4NSwtMjk0LjY3MzkgMjA1LjMwMjYsLTI4OC44MDY1Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjI2My4xMDY5IiB5PSItMzE0LjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCIgZmlsbD0iIzAwMDAwMCI+YTwvdGV4dD4KPC9nPgo8IS0tIDE0IC0tPgo8ZyBpZD0ibm9kZTE1IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT4xNDwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjIzNCIgY3k9Ii0yNzYiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSAwJiM0NTsmZ3Q7MTQgLS0+CjxnIGlkPSJlZGdlMTQiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjAmIzQ1OyZndDsxNDwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTMxMy42NzU0LC0zNDkuNjc4M0MyOTguMzQ0MSwtMzM1LjUwMSAyNzIuOTczNCwtMzEyLjAzOTkgMjU0Ljk4MzYsLTI5NS40MDQyIi8+Cjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgcG9pbnRzPSIyNTcuMDE4MiwtMjkyLjUxODUgMjQ3LjI5OTksLTI4OC4yOTg4IDI1Mi4yNjU2LC0yOTcuNjU3OSAyNTcuMDE4MiwtMjkyLjUxODUiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjkwLjUiIHk9Ii0zMTQuOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIiBmaWxsPSIjMDAwMDAwIj5oPC90ZXh0Pgo8L2c+CjwhLS0gMTUgLS0+CjxnIGlkPSJub2RlMTYiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjE1PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iMjg4IiBjeT0iLTI3NiIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDAmIzQ1OyZndDsxNSAtLT4KPGcgaWQ9ImVkZ2UxNSIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+MCYjNDU7Jmd0OzE1PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBkPSJNMzE5LjQ4MDQsLTM0NS40MTgzQzMxMy44NjkzLC0zMzMuMDQ1MSAzMDYuMDk3MywtMzE1LjkwNjkgMjk5LjY3OTgsLTMwMS43NTU1Ii8+Cjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgcG9pbnRzPSIzMDIuODE0MiwtMzAwLjE5MjUgMjk1LjQ5NjUsLTI5Mi41MzA4IDI5Ni40MzkxLC0zMDMuMDgzNiAzMDIuODE0MiwtMzAwLjE5MjUiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMzEzLjEwNjkiIHk9Ii0zMTQuOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIiBmaWxsPSIjMDAwMDAwIj5jPC90ZXh0Pgo8L2c+CjwhLS0gMTcgLS0+CjxnIGlkPSJub2RlMTgiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjE3PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iMzQyIiBjeT0iLTI3NiIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDAmIzQ1OyZndDsxNyAtLT4KPGcgaWQ9ImVkZ2UxNyIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+MCYjNDU7Jmd0OzE3PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBkPSJNMzMwLjEwOCwtMzQ0LjE4MDdDMzMyLjEzOTMsLTMzMi41MzQ0IDMzNC44MzQ0LC0zMTcuMDgyOSAzMzcuMTQ1MiwtMzAzLjgzNDQiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjM0MC42MjU2LC0zMDQuMjQ5MSAzMzguODk2LC0yOTMuNzk2NCAzMzMuNzI5NywtMzAzLjA0NjMgMzQwLjYyNTYsLTMwNC4yNDkxIi8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjMzOS41IiB5PSItMzE0LjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCIgZmlsbD0iIzAwMDAwMCI+bzwvdGV4dD4KPC9nPgo8IS0tIDE4IC0tPgo8ZyBpZD0ibm9kZTE5IiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT4xODwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjM5NiIgY3k9Ii0yNzYiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSAwJiM0NTsmZ3Q7MTggLS0+CjxnIGlkPSJlZGdlMTgiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjAmIzQ1OyZndDsxODwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTMzOC4zOTM5LC0zNDcuNzk4OEMzNDkuMTgwOSwtMzM0LjM1NDIgMzY1LjU0NTQsLTMxMy45NTc5IDM3OC4wNzk1LC0yOTguMzM1NiIvPgo8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50cz0iMzgxLjA2MSwtMzAwLjIxMjQgMzg0LjU4OTEsLTI5MC4yMjIyIDM3NS42MDExLC0yOTUuODMxOCAzODEuMDYxLC0zMDAuMjEyNCIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIzNjkuNSIgeT0iLTMxNC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiIGZpbGw9IiMwMDAwMDAiPm48L3RleHQ+CjwvZz4KPCEtLSAyMCAtLT4KPGcgaWQ9Im5vZGUyMSIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+MjA8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGN4PSI0NTAiIGN5PSItMjc2IiByeD0iMTgiIHJ5PSIxOCIvPgo8L2c+CjwhLS0gMCYjNDU7Jmd0OzIwIC0tPgo8ZyBpZD0iZWRnZTIwIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT4wJiM0NTsmZ3Q7MjA8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGQ9Ik0zNDIuMDgyMiwtMzUxLjQ1NDdDMzYzLjIyMTUsLTMzNi42NzQ0IDQwMS44NTM2LC0zMDkuNjYzMyA0MjYuNzA0NSwtMjkyLjI4NzkiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjQyOC45ODg3LC0yOTQuOTYxNSA0MzUuMTc4NiwtMjg2LjM2MjkgNDI0Ljk3NzYsLTI4OS4yMjQ3IDQyOC45ODg3LC0yOTQuOTYxNSIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIzOTcuOTQ0OCIgeT0iLTMxNC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiIGZpbGw9IiMwMDAwMDAiPmw8L3RleHQ+CjwvZz4KPCEtLSAyMSAtLT4KPGcgaWQ9Im5vZGUyMiIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+MjE8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGN4PSI1MDQiIGN5PSItMjc2IiByeD0iMTgiIHJ5PSIxOCIvPgo8L2c+CjwhLS0gMCYjNDU7Jmd0OzIxIC0tPgo8ZyBpZD0iZWRnZTIxIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT4wJiM0NTsmZ3Q7MjE8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGQ9Ik0zNDQuMDgyOCwtMzU1LjMxOEMzNzIuMzg3OSwtMzQ0LjAxMzkgNDMwLjUwMjksLTMxOS44MTQzIDQ3NywtMjk0IDQ3OC4xMzU5LC0yOTMuMzY5MyA0NzkuMjg2MywtMjkyLjcwNjIgNDgwLjQzOTQsLTI5Mi4wMjE2Ii8+Cjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgcG9pbnRzPSI0ODIuNTQ0NiwtMjk0LjgzMTggNDg5LjEzMzYsLTI4Ni41MzUgNDc4LjgwODgsLTI4OC45MTIgNDgyLjU0NDYsLTI5NC44MzE4Ii8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjQ0Mi45NDQ4IiB5PSItMzE0LjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCIgZmlsbD0iIzAwMDAwMCI+aTwvdGV4dD4KPC9nPgo8IS0tIDIyIC0tPgo8ZyBpZD0ibm9kZTIzIiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT4yMjwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjU1OCIgY3k9Ii0yNzYiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSAwJiM0NTsmZ3Q7MjIgLS0+CjxnIGlkPSJlZGdlMjIiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjAmIzQ1OyZndDsyMjwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTM0NC42Njk5LC0zNTguMTEzNUMzODAuOTk2MywtMzQ5LjcwMDEgNDY2LjA5ODQsLTMyNy43OTE0IDUzMSwtMjk0IDUzMi4xNTI0LC0yOTMuNCA1MzMuMzE2MywtMjkyLjc2MiA1MzQuNDgwMywtMjkyLjA5NzciLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjUzNi41NTc2LC0yOTQuOTI4MSA1NDMuMjE0OCwtMjg2LjY4NiA1MzIuODcwNywtMjg4Ljk3NzcgNTM2LjU1NzYsLTI5NC45MjgxIi8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjQ5NC4wNTUyIiB5PSItMzE0LjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCIgZmlsbD0iIzAwMDAwMCI+dzwvdGV4dD4KPC9nPgo8IS0tIDIgLS0+CjxnIGlkPSJub2RlMyIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+MjwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjE4IiBjeT0iLTE5MCIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDEmIzQ1OyZndDsyIC0tPgo8ZyBpZD0iZWRnZTIiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjEmIzQ1OyZndDsyPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBkPSJNNjIuMzQ1OSwtMjYwLjYyNDlDNTQuMjU2NSwtMjQ3Ljc0MTggNDIuNTY0NSwtMjI5LjEyMTMgMzMuMjE2OCwtMjE0LjIzNDIiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjM2LjAzNDUsLTIxMi4xMzk2IDI3Ljc1MjYsLTIwNS41MzE5IDMwLjEwNjIsLTIxNS44NjIgMzYuMDM0NSwtMjEyLjEzOTYiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNTIuMTA2OSIgeT0iLTIyOC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiIGZpbGw9IiMwMDAwMDAiPmE8L3RleHQ+CjwvZz4KPCEtLSAzIC0tPgo8ZyBpZD0ibm9kZTQiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjM8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGN4PSI3MiIgY3k9Ii0xOTAiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSAxJiM0NTsmZ3Q7MyAtLT4KPGcgaWQ9ImVkZ2UzIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT4xJiM0NTsmZ3Q7MzwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTcyLC0yNTcuNzYxNkM3MiwtMjQ2LjM1OTcgNzIsLTIzMS40MzQyIDcyLC0yMTguNDk0Ii8+Cjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgcG9pbnRzPSI3NS41MDAxLC0yMTguMjEyMSA3MiwtMjA4LjIxMjEgNjguNTAwMSwtMjE4LjIxMjEgNzUuNTAwMSwtMjE4LjIxMjEiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNzUuMTA2OSIgeT0iLTIyOC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiIGZpbGw9IiMwMDAwMDAiPmM8L3RleHQ+CjwvZz4KPCEtLSA0IC0tPgo8ZyBpZD0ibm9kZTUiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjQ8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGN4PSI3MiIgY3k9Ii0xMDQiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSAzJiM0NTsmZ3Q7NCAtLT4KPGcgaWQ9ImVkZ2U0IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT4zJiM0NTsmZ3Q7NDwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTcyLC0xNzEuNzYxNkM3MiwtMTYwLjM1OTcgNzIsLTE0NS40MzQyIDcyLC0xMzIuNDk0Ii8+Cjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgcG9pbnRzPSI3NS41MDAxLC0xMzIuMjEyMSA3MiwtMTIyLjIxMjEgNjguNTAwMSwtMTMyLjIxMjEgNzUuNTAwMSwtMTMyLjIxMjEiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNzQuMzMxMSIgeT0iLTE0Mi44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiIGZpbGw9IiMwMDAwMDAiPnI8L3RleHQ+CjwvZz4KPCEtLSA1IC0tPgo8ZyBpZD0ibm9kZTYiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjU8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGN4PSI3MiIgY3k9Ii0xOCIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDQmIzQ1OyZndDs1IC0tPgo8ZyBpZD0iZWRnZTUiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjQmIzQ1OyZndDs1PC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBkPSJNNzIsLTg1Ljc2MTZDNzIsLTc0LjM1OTcgNzIsLTU5LjQzNDIgNzIsLTQ2LjQ5NCIvPgo8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50cz0iNzUuNTAwMSwtNDYuMjEyMSA3MiwtMzYuMjEyMSA2OC41MDAxLC00Ni4yMTIxIDc1LjUwMDEsLTQ2LjIxMjEiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iNzUuMTA2OSIgeT0iLTU2LjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCIgZmlsbD0iIzAwMDAwMCI+ZTwvdGV4dD4KPC9nPgo8IS0tIDggLS0+CjxnIGlkPSJub2RlOSIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+ODwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjEyNiIgY3k9Ii0xOTAiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSA3JiM0NTsmZ3Q7OCAtLT4KPGcgaWQ9ImVkZ2U4IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT43JiM0NTsmZ3Q7ODwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTE3MC4zNDU5LC0yNjAuNjI0OUMxNjIuMjU2NSwtMjQ3Ljc0MTggMTUwLjU2NDUsLTIyOS4xMjEzIDE0MS4yMTY4LC0yMTQuMjM0MiIvPgo8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50cz0iMTQ0LjAzNDUsLTIxMi4xMzk2IDEzNS43NTI2LC0yMDUuNTMxOSAxMzguMTA2MiwtMjE1Ljg2MiAxNDQuMDM0NSwtMjEyLjEzOTYiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMTYwLjUiIHk9Ii0yMjguOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIiBmaWxsPSIjMDAwMDAwIj5fPC90ZXh0Pgo8L2c+CjwhLS0gOSAtLT4KPGcgaWQ9Im5vZGUxMCIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+OTwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjE4MCIgY3k9Ii0xOTAiIHJ4PSIxOCIgcnk9IjE4Ii8+CjwvZz4KPCEtLSA3JiM0NTsmZ3Q7OSAtLT4KPGcgaWQ9ImVkZ2U5IiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT43JiM0NTsmZ3Q7OTwvdGl0bGU+CjxwYXRoIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgZD0iTTE4MCwtMjU3Ljc2MTZDMTgwLC0yNDYuMzU5NyAxODAsLTIzMS40MzQyIDE4MCwtMjE4LjQ5NCIvPgo8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50cz0iMTgzLjUwMDEsLTIxOC4yMTIxIDE4MCwtMjA4LjIxMjEgMTc2LjUwMDEsLTIxOC4yMTIxIDE4My41MDAxLC0yMTguMjEyMSIvPgo8dGV4dCB0ZXh0LWFuY2hvcj0ibWlkZGxlIiB4PSIxODUuNDQ0OCIgeT0iLTIyOC44IiBmb250LWZhbWlseT0iVGltZXMsc2VyaWYiIGZvbnQtc2l6ZT0iMTQuMDAiIGZpbGw9IiMwMDAwMDAiPm08L3RleHQ+CjwvZz4KPCEtLSAxMiAtLT4KPGcgaWQ9Im5vZGUxMyIgY2xhc3M9Im5vZGUiPgo8dGl0bGU+MTI8L3RpdGxlPgo8ZWxsaXBzZSBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGN4PSIyMzQiIGN5PSItMTkwIiByeD0iMTgiIHJ5PSIxOCIvPgo8L2c+CjwhLS0gNyYjNDU7Jmd0OzEyIC0tPgo8ZyBpZD0iZWRnZTEyIiBjbGFzcz0iZWRnZSI+Cjx0aXRsZT43JiM0NTsmZ3Q7MTI8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGQ9Ik0xODkuNjU0MSwtMjYwLjYyNDlDMTk3Ljc0MzUsLTI0Ny43NDE4IDIwOS40MzU1LC0yMjkuMTIxMyAyMTguNzgzMiwtMjE0LjIzNDIiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjIyMS44OTM4LC0yMTUuODYyIDIyNC4yNDc0LC0yMDUuNTMxOSAyMTUuOTY1NSwtMjEyLjEzOTYgMjIxLjg5MzgsLTIxNS44NjIiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjE0LjUiIHk9Ii0yMjguOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIiBmaWxsPSIjMDAwMDAwIj5uPC90ZXh0Pgo8L2c+CjwhLS0gMTAgLS0+CjxnIGlkPSJub2RlMTEiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjEwPC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iMTgwIiBjeT0iLTEwNCIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDkmIzQ1OyZndDsxMCAtLT4KPGcgaWQ9ImVkZ2UxMCIgY2xhc3M9ImVkZ2UiPgo8dGl0bGU+OSYjNDU7Jmd0OzEwPC90aXRsZT4KPHBhdGggZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBkPSJNMTgwLC0xNzEuNzYxNkMxODAsLTE2MC4zNTk3IDE4MCwtMTQ1LjQzNDIgMTgwLC0xMzIuNDk0Ii8+Cjxwb2x5Z29uIGZpbGw9IiMwMDAwMDAiIHN0cm9rZT0iIzAwMDAwMCIgcG9pbnRzPSIxODMuNTAwMSwtMTMyLjIxMjEgMTgwLC0xMjIuMjEyMSAxNzYuNTAwMSwtMTMyLjIxMjEgMTgzLjUwMDEsLTEzMi4yMTIxIi8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjE4My41IiB5PSItMTQyLjgiIGZvbnQtZmFtaWx5PSJUaW1lcyxzZXJpZiIgZm9udC1zaXplPSIxNC4wMCIgZmlsbD0iIzAwMDAwMCI+XzwvdGV4dD4KPC9nPgo8IS0tIDExIC0tPgo8ZyBpZD0ibm9kZTEyIiBjbGFzcz0ibm9kZSI+Cjx0aXRsZT4xMTwvdGl0bGU+CjxlbGxpcHNlIGZpbGw9Im5vbmUiIHN0cm9rZT0iIzAwMDAwMCIgY3g9IjE4MCIgY3k9Ii0xOCIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDEwJiM0NTsmZ3Q7MTEgLS0+CjxnIGlkPSJlZGdlMTEiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjEwJiM0NTsmZ3Q7MTE8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGQ9Ik0xODAsLTg1Ljc2MTZDMTgwLC03NC4zNTk3IDE4MCwtNTkuNDM0MiAxODAsLTQ2LjQ5NCIvPgo8cG9seWdvbiBmaWxsPSIjMDAwMDAwIiBzdHJva2U9IiMwMDAwMDAiIHBvaW50cz0iMTgzLjUwMDEsLTQ2LjIxMjEgMTgwLC0zNi4yMTIxIDE3Ni41MDAxLC00Ni4yMTIxIDE4My41MDAxLC00Ni4yMTIxIi8+Cjx0ZXh0IHRleHQtYW5jaG9yPSJtaWRkbGUiIHg9IjE4My4xMDY5IiB5PSItNTYuOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIiBmaWxsPSIjMDAwMDAwIj5jPC90ZXh0Pgo8L2c+CjwhLS0gMTMgLS0+CjxnIGlkPSJub2RlMTQiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjEzPC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iMjM0IiBjeT0iLTEwNCIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDEyJiM0NTsmZ3Q7MTMgLS0+CjxnIGlkPSJlZGdlMTMiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjEyJiM0NTsmZ3Q7MTM8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGQ9Ik0yMzQsLTE3MS43NjE2QzIzNCwtMTYwLjM1OTcgMjM0LC0xNDUuNDM0MiAyMzQsLTEzMi40OTQiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjIzNy41MDAxLC0xMzIuMjEyMSAyMzQsLTEyMi4yMTIxIDIzMC41MDAxLC0xMzIuMjEyMSAyMzcuNTAwMSwtMTMyLjIxMjEiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjM3LjUiIHk9Ii0xNDIuOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIiBmaWxsPSIjMDAwMDAwIj4kPC90ZXh0Pgo8L2c+CjwhLS0gMTYgLS0+CjxnIGlkPSJub2RlMTciIGNsYXNzPSJub2RlIj4KPHRpdGxlPjE2PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iMjg4IiBjeT0iLTE5MCIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDE1JiM0NTsmZ3Q7MTYgLS0+CjxnIGlkPSJlZGdlMTYiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjE1JiM0NTsmZ3Q7MTY8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGQ9Ik0yODgsLTI1Ny43NjE2QzI4OCwtMjQ2LjM1OTcgMjg4LC0yMzEuNDM0MiAyODgsLTIxOC40OTQiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjI5MS41MDAxLC0yMTguMjEyMSAyODgsLTIwOC4yMTIxIDI4NC41MDAxLC0yMTguMjEyMSAyOTEuNTAwMSwtMjE4LjIxMjEiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMjg5Ljk0NDgiIHk9Ii0yMjguOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIiBmaWxsPSIjMDAwMDAwIj5sPC90ZXh0Pgo8L2c+CjwhLS0gMTkgLS0+CjxnIGlkPSJub2RlMjAiIGNsYXNzPSJub2RlIj4KPHRpdGxlPjE5PC90aXRsZT4KPGVsbGlwc2UgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iMzk2IiBjeT0iLTE5MCIgcng9IjE4IiByeT0iMTgiLz4KPC9nPgo8IS0tIDE4JiM0NTsmZ3Q7MTkgLS0+CjxnIGlkPSJlZGdlMTkiIGNsYXNzPSJlZGdlIj4KPHRpdGxlPjE4JiM0NTsmZ3Q7MTk8L3RpdGxlPgo8cGF0aCBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAwMDAiIGQ9Ik0zOTYsLTI1Ny43NjE2QzM5NiwtMjQ2LjM1OTcgMzk2LC0yMzEuNDM0MiAzOTYsLTIxOC40OTQiLz4KPHBvbHlnb24gZmlsbD0iIzAwMDAwMCIgc3Ryb2tlPSIjMDAwMDAwIiBwb2ludHM9IjM5OS41MDAxLC0yMTguMjEyMSAzOTYsLTIwOC4yMTIxIDM5Mi41MDAxLC0yMTguMjEyMSAzOTkuNTAwMSwtMjE4LjIxMjEiLz4KPHRleHQgdGV4dC1hbmNob3I9Im1pZGRsZSIgeD0iMzk5LjUiIHk9Ii0yMjguOCIgZm9udC1mYW1pbHk9IlRpbWVzLHNlcmlmIiBmb250LXNpemU9IjE0LjAwIiBmaWxsPSIjMDAwMDAwIj5fPC90ZXh0Pgo8L2c+CjwvZz4KPC9zdmc+Cg==

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It cannot produce less than $\sqrt{n}$ phrases, even in the text $T=a^n\$$. Why ??</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="LZ76">LZ76<a class="anchor-link" href="#LZ76">&#182;</a></h2><p>The Lempel-Ziv 1976 compression is somehow similar to LZ78, in which the text is parsed into a sequence of phrases. While in LZ78 the next phrase to be find after parsing $T[1,i]$ must be a previous found phrase plus the symbol following it, in LZ76 the phrase is the longest prefix of $T[i+1,n]$ that has already appeared in the text plus the symbol following it. If the next phrase foud is $T[i+1,j] = T[i',j'].T[j]$, the LZ76 compression algorithm encodes the phrase as the triple $(i´,j-i-1,T[j])$.</p>
<p>Often LZ76 is mistaken with LZ77, a variant that restricts the length $l$ of the sliding window $T[i-l,i]$ from where the phrases can be detected. This constraint simplifies the finding and enconding the phrases and has the drawback to restrict the search to "nearby" regions in the text.</p>
<p><strong>Lemma:</strong> The z distinct phrases that LZ compression algorithms generate have $O(n/log_{\sigma}n)$.</p>
<p><em>Proof:</em> Let $\sigma$ be the length of the alphabet used. Listing all the distict phrases in sorted order of length we'll have:</p>
<ul>
<li>$\sigma$ phrases of length 1;</li>
<li>$\sigma^2$ phases of length 2;</li>
<li>$\sigma^3$ phrases of length 3;</li>
<li>and so on;
TO BE CONTINUED</li>
</ul>
<p>The LZ76 phrases can be found in linear time with the help of a suffix tree (Rodeh et al, 1981), but this structure requires a lot of extra space, which hampers the parsing of large texts.</p>
<h3 id="The-suffix-tree-data-structure">The suffix tree data structure<a class="anchor-link" href="#The-suffix-tree-data-structure">&#182;</a></h3><p>Naive methods to build a suffix tree:</p>
<ol>
<li><p>Build the ST from the suffix trie data structure. This method takes $O(m^2)$ time and $O(m^2)$ space.</p>
</li>
<li><p>Recursively augment the tree starting from a two-edge tree representing the longest suffix. Then, insert the 2nd longest suffix. Then, the 3rd longest suffix. And so on. It takes $O(m)$ space but still $O(m^2)$ time (Gusfield, section 5.4).</p>
</li>
</ol>
<p>The suffix tree implementation below was borrowed from <a href="http://www.langmead-lab.org/teaching-materials/">Ben Langmead teaching materials</a> (which I highly recommend) and follows the Gusfield algorithm presented in section 5.4. I slightly modified the implementation to accomodate the $m$ suffix numbers in the nodes, where $m$ is the number of suffixes from text $T$. This number will be important in the implementation of the LZ76 parser using suffix trees.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">SuffixTree</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lab</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lab</span> <span class="o">=</span> <span class="n">lab</span> <span class="c1"># label on path leading to this node</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># outgoing edges; maps characters to nodes</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span>
      
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;$&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># trie for just longest suffix</span>
    <span class="c1"># add the rest of the suffixes, from longest to shortest</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
      <span class="c1"># start at root; we&#39;ll walking down as far as we can go</span>
      <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
      <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
      <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">:</span>
          <span class="n">child</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
          <span class="n">lab</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">lab</span>
          <span class="c1"># walk along edge until we exhaust edge label or until we mismatch</span>
          <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span>
          <span class="k">while</span> <span class="n">k</span><span class="o">-</span><span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">lab</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
          <span class="k">if</span> <span class="n">k</span><span class="o">-</span><span class="n">j</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">):</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">child</span> <span class="c1"># we exhausted the edge</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">k</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="c1"># we fell off in middle of edge</span>
            <span class="n">cExist</span><span class="p">,</span> <span class="n">cNew</span> <span class="o">=</span> <span class="n">lab</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">j</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># create &quot;mid&quot;: new node bisecting edge</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">lab</span><span class="p">[:</span><span class="n">k</span><span class="o">-</span><span class="n">j</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">mid</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">cNew</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">:],</span> <span class="n">i</span><span class="p">)</span>
            <span class="c1"># original child becomes mid&#39;s child</span>
            <span class="n">mid</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">cExist</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span>
            <span class="c1"># original child&#39;s label is curtailed</span>
            <span class="n">child</span><span class="o">.</span><span class="n">lab</span> <span class="o">=</span> <span class="n">lab</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">j</span><span class="p">:]</span>
            <span class="c1"># mid becomes new child of original parent</span>
            <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mid</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="c1"># Fell off tree at a node: make new edge hanging off it</span>
          <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">:],</span><span class="n">i</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">followPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Follow path given by s.  If we fall off tree, return None.  If we</span>
<span class="sd">        finish mid-edge, return (node, offset) where &#39;node&#39; is child and</span>
<span class="sd">        &#39;offset&#39; is label offset.  If we finish on a node, return (node,</span>
<span class="sd">        None). &quot;&quot;&quot;</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># fell off at a node</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">lab</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">lab</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">while</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">lab</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">):</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">child</span> <span class="c1"># exhausted edge</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">j</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="c1"># exhausted query string in middle of edge</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># fell off in the middle of the edge</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">cur</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># exhausted query string at internal node</span>

  <span class="k">def</span> <span class="nf">hasSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Return true iff s appears as a substring &quot;&quot;&quot;</span>
      <span class="n">node</span><span class="p">,</span> <span class="n">off</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">followPath</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

  <span class="k">def</span> <span class="nf">hasSuffix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Return true iff s is a suffix &quot;&quot;&quot;</span>
      <span class="n">node</span><span class="p">,</span> <span class="n">off</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">followPath</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
          <span class="k">return</span> <span class="kc">False</span> <span class="c1"># fell off the tree</span>
      <span class="k">if</span> <span class="n">off</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
          <span class="c1"># finished on top of a node</span>
          <span class="k">return</span> <span class="s1">&#39;$&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">out</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="c1"># finished at offset &#39;off&#39; within an edge leading to &#39;node&#39;</span>
          <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">lab</span><span class="p">[</span><span class="n">off</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;$&#39;</span>

  <span class="k">def</span> <span class="nf">_iterate_over_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">_to_iter</span><span class="p">(</span><span class="n">node</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Node lab=</span><span class="si">{}</span><span class="s2">, id=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">lab</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">idx</span><span class="p">))</span>
          <span class="n">_to_iter</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
    <span class="n">_to_iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">numerate_internal_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">preorder_traversal</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
      <span class="k">yield</span> <span class="n">root</span>
      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">preorder_traversal</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">preorder_traversal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
    
  <span class="k">def</span> <span class="nf">to_dot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Return dot representation of trie to make a picture &quot;&quot;&quot;</span>
      <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">def</span> <span class="nf">_to_dot_helper</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">parid</span><span class="p">):</span>
          <span class="n">childid</span> <span class="o">=</span> <span class="n">parid</span>
          <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="c1">#              print(c, child)</span>
              <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%d</span><span class="s1"> -&gt; </span><span class="si">%d</span><span class="s1"> [ label=&quot;</span><span class="si">%s</span><span class="s1">&quot; ];&#39;</span> <span class="o">%</span> 
                           <span class="p">(</span><span class="n">parid</span><span class="p">,</span> <span class="n">childid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">lab</span><span class="p">))</span>
              <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{}</span><span class="s1"> [label=&quot;</span><span class="si">{}</span><span class="s1">&quot;];&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">childid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">idx</span><span class="p">))</span>
              <span class="n">childid</span> <span class="o">=</span> <span class="n">_to_dot_helper</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">childid</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">childid</span>
      <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;digraph &quot;Suffix trie&quot; {&#39;</span><span class="p">)</span>
      <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  node [shape=circle label=&quot;&quot;];&#39;</span><span class="p">)</span>
      <span class="n">_to_dot_helper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">)</span>
      <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The example shown by Langsmead in his lecture about suffix trees is reproduced below, i.e. $T=abaaba$. The leaf nodes were labeled with the corresponding suffix number. Internal nodes dont have labels.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stree</span> <span class="o">=</span> <span class="n">SuffixTree</span><span class="p">(</span><span class="s1">&#39;abaaba&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[7]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">dotstr</span> stree.to_dot()
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Suffix trie Pages: 1 -->
<svg width="260pt" height="305pt"
 viewBox="0.00 0.00 260.00 305.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 301)">
<title>Suffix trie</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-301 256,-301 256,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<ellipse fill="none" stroke="#000000" cx="180" cy="-279" rx="18" ry="18"/>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<ellipse fill="none" stroke="#000000" cx="104" cy="-192" rx="18" ry="18"/>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="#000000" d="M168.125,-265.4063C156.0376,-251.5694 137.115,-229.9079 122.9529,-213.6961"/>
<polygon fill="#000000" stroke="#000000" points="125.2573,-211.0139 116.0424,-205.7854 119.9855,-215.6192 125.2573,-211.0139"/>
<text text-anchor="middle" x="150.5" y="-231.8" font-family="Times,serif" font-size="14.00" fill="#000000">a</text>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<ellipse fill="none" stroke="#000000" cx="180" cy="-192" rx="18" ry="18"/>
</g>
<!-- 0&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>0&#45;&gt;7</title>
<path fill="none" stroke="#000000" d="M180,-260.9735C180,-249.1918 180,-233.5607 180,-220.1581"/>
<polygon fill="#000000" stroke="#000000" points="183.5001,-220.0033 180,-210.0034 176.5001,-220.0034 183.5001,-220.0033"/>
<text text-anchor="middle" x="187" y="-231.8" font-family="Times,serif" font-size="14.00" fill="#000000">ba</text>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<ellipse fill="none" stroke="#000000" cx="234" cy="-192" rx="18" ry="18"/>
<text text-anchor="middle" x="234" y="-188.3" font-family="Times,serif" font-size="14.00" fill="#000000">6</text>
</g>
<!-- 0&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>0&#45;&gt;10</title>
<path fill="none" stroke="#000000" d="M189.6541,-263.4461C197.7938,-250.3322 209.5808,-231.342 218.9571,-216.2358"/>
<polygon fill="#000000" stroke="#000000" points="222.1295,-217.7614 224.4295,-207.4192 216.182,-214.0698 222.1295,-217.7614"/>
<text text-anchor="middle" x="214" y="-231.8" font-family="Times,serif" font-size="14.00" fill="#000000">$</text>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<ellipse fill="none" stroke="#000000" cx="18" cy="-105" rx="18" ry="18"/>
<text text-anchor="middle" x="18" y="-101.3" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- 1&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>1&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M88.4654,-182.397C78.3174,-175.7056 65.1209,-166.1818 55,-156 47.0184,-147.9703 39.4428,-138.0971 33.2495,-129.1836"/>
<polygon fill="#000000" stroke="#000000" points="36.0313,-127.0477 27.5532,-120.6938 30.2185,-130.9479 36.0313,-127.0477"/>
<text text-anchor="middle" x="69" y="-144.8" font-family="Times,serif" font-size="14.00" fill="#000000">aba$</text>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<ellipse fill="none" stroke="#000000" cx="72" cy="-105" rx="18" ry="18"/>
</g>
<!-- 1&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>1&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M97.6778,-174.8116C93.1635,-162.5383 87.0028,-145.7887 81.8474,-131.7725"/>
<polygon fill="#000000" stroke="#000000" points="85.046,-130.3297 78.309,-122.1527 78.4763,-132.7462 85.046,-130.3297"/>
<text text-anchor="middle" x="97" y="-144.8" font-family="Times,serif" font-size="14.00" fill="#000000">ba</text>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<ellipse fill="none" stroke="#000000" cx="126" cy="-105" rx="18" ry="18"/>
<text text-anchor="middle" x="126" y="-101.3" font-family="Times,serif" font-size="14.00" fill="#000000">5</text>
</g>
<!-- 1&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>1&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M108.452,-174.3943C111.4936,-162.3661 115.5854,-146.1851 119.0526,-132.4737"/>
<polygon fill="#000000" stroke="#000000" points="122.4961,-133.1325 121.5546,-122.5796 115.7098,-131.4163 122.4961,-133.1325"/>
<text text-anchor="middle" x="121" y="-144.8" font-family="Times,serif" font-size="14.00" fill="#000000">$</text>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<ellipse fill="none" stroke="#000000" cx="45" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="45" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- 3&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>3&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M66.5361,-87.3943C62.7787,-75.287 57.7155,-58.972 53.4424,-45.2034"/>
<polygon fill="#000000" stroke="#000000" points="56.6704,-43.7959 50.3636,-35.2827 49.9849,-45.8707 56.6704,-43.7959"/>
<text text-anchor="middle" x="65" y="-57.8" font-family="Times,serif" font-size="14.00" fill="#000000">$</text>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<ellipse fill="none" stroke="#000000" cx="99" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="99" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">0</text>
</g>
<!-- 3&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>3&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M77.4639,-87.3943C81.2213,-75.287 86.2845,-58.972 90.5576,-45.2034"/>
<polygon fill="#000000" stroke="#000000" points="94.0151,-45.8707 93.6364,-35.2827 87.3296,-43.7959 94.0151,-45.8707"/>
<text text-anchor="middle" x="102" y="-57.8" font-family="Times,serif" font-size="14.00" fill="#000000">aba$</text>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<ellipse fill="none" stroke="#000000" cx="180" cy="-105" rx="18" ry="18"/>
<text text-anchor="middle" x="180" y="-101.3" font-family="Times,serif" font-size="14.00" fill="#000000">4</text>
</g>
<!-- 7&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>7&#45;&gt;8</title>
<path fill="none" stroke="#000000" d="M180,-173.9735C180,-162.1918 180,-146.5607 180,-133.1581"/>
<polygon fill="#000000" stroke="#000000" points="183.5001,-133.0033 180,-123.0034 176.5001,-133.0034 183.5001,-133.0033"/>
<text text-anchor="middle" x="184" y="-144.8" font-family="Times,serif" font-size="14.00" fill="#000000">$</text>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<ellipse fill="none" stroke="#000000" cx="234" cy="-105" rx="18" ry="18"/>
<text text-anchor="middle" x="234" y="-101.3" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- 7&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>7&#45;&gt;9</title>
<path fill="none" stroke="#000000" d="M189.6541,-176.4461C197.7938,-163.3322 209.5808,-144.342 218.9571,-129.2358"/>
<polygon fill="#000000" stroke="#000000" points="222.1295,-130.7614 224.4295,-120.4192 216.182,-127.0698 222.1295,-130.7614"/>
<text text-anchor="middle" x="224" y="-144.8" font-family="Times,serif" font-size="14.00" fill="#000000">aba$</text>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now that we have a suffix tree implementation we can go back to LZ76 parsing algorithm.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Naive-LZ76-parsing-algorithm">Naive LZ76 parsing algorithm<a class="anchor-link" href="#Naive-LZ76-parsing-algorithm">&#182;</a></h1><p>The algorithm relies on the suffix tree (ST) for string $T$ to find longest prefix of $T[i,n]$.</p>
<ol>
<li><p>Build an ST for string $T$;</p>
</li>
<li><p>Number each internal node $v$ with $c_v$, the smallest number of all the suffixes in $v$´s subtree; this way, $c_v$ is the left most position in $T$ of any copy of the substring on the path from root to node $v$;</p>
</li>
<li><p>To obtain the encoding (position, length) for the substring $T[i, n]$, whith $0 \leq i \leq n$, do:</p>
<p>a. Follow the only path from the root that matches the prefix $T[i, n]$;</p>
<p>b. The traversal stops at point $p$ which not necessarily is a node, when a character breaks the match; let depth(p) be the length of the string from the root to p and v the first node at of below p;</p>
<p>c. Do position &lt;- $c_v$ and length &lt;- depth(p);</p>
<p>d. Output encoding (position, length, S[j]), with $j=i+length$;</p>
<p>e. Do i &lt;- j+1; if i = n stop; else goto 3.</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li><p>Build an ST for string $T$;</p>
</li>
<li><p>Number each internal node $v$ with $c_v$, the smallest number of all the suffixes in $v$´s subtree; this way, $c_v$ is the left most position in $T$ of any copy of the substring on the path from root to node $v$;</p>
</li>
<li><p>To obtain the encoding (position, length) for the substring $T[i, n]$, whith $0 \leq i \leq n$, do:</p>
<p>a. Follow the only path from the root that matches the prefix $T[i, n]$;</p>
<p>b. The traversal stops at point $p$ which not necessarily is a node, when a character breaks the match; let depth(p) be the length of the string from the root to p and v the first node at of below p;</p>
<p>c. Do position &lt;- $c_v$ and length &lt;- depth(p);</p>
<p>d. Output encoding (position, length, S[j]), with $j=i+length$;</p>
<p>e. Do i &lt;- j+1; if i = n stop; else goto 3.</p>
</li>
</ol>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>

<span class="k">class</span> <span class="nc">SuffixTreeLZ76</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">class</span> <span class="nc">Node</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lab</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">lab</span> <span class="o">=</span> <span class="n">lab</span> <span class="c1"># label on path leading to this node</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">out</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># outgoing edges; maps characters to nodes</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="n">idx</span>
      
    <span class="c1">#def __hash__(self):</span>
    <span class="c1">#    return hash((self.lab, self.out, self.idx))</span>

    <span class="c1">#def __eq__(self, other):</span>
    <span class="c1">#    if not isinstance(other, type(self)): return NotImplemented</span>
    <span class="c1">#    return self.lab == other.lab and self.out == other.out and self.idx == other.idx</span>
      
  <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">+=</span> <span class="s1">&#39;$&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># trie for just longest suffix</span>
    <span class="c1"># add the rest of the suffixes, from longest to shortest</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
      <span class="c1"># start at root; we&#39;ll walking down as far as we can go</span>
      <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
      <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
      <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">:</span>
          <span class="n">child</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span>
          <span class="n">lab</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">lab</span>
          <span class="c1"># walk along edge until we exhaust edge label or until we mismatch</span>
          <span class="n">k</span> <span class="o">=</span> <span class="n">j</span><span class="o">+</span><span class="mi">1</span>
          <span class="k">while</span> <span class="n">k</span><span class="o">-</span><span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">lab</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">j</span><span class="p">]:</span>
            <span class="n">k</span> <span class="o">+=</span> <span class="mi">1</span>
          <span class="k">if</span> <span class="n">k</span><span class="o">-</span><span class="n">j</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">):</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">child</span> <span class="c1"># we exhausted the edge</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">k</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="c1"># we fell off in middle of edge</span>
            <span class="n">cExist</span><span class="p">,</span> <span class="n">cNew</span> <span class="o">=</span> <span class="n">lab</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">j</span><span class="p">],</span> <span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="c1"># create &quot;mid&quot;: new node bisecting edge</span>
            <span class="n">mid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">lab</span><span class="p">[:</span><span class="n">k</span><span class="o">-</span><span class="n">j</span><span class="p">],</span> <span class="kc">None</span><span class="p">)</span>
            <span class="n">mid</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">cNew</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">k</span><span class="p">:],</span> <span class="n">i</span><span class="p">)</span>
            <span class="c1"># original child becomes mid&#39;s child</span>
            <span class="n">mid</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">cExist</span><span class="p">]</span> <span class="o">=</span> <span class="n">child</span>
            <span class="c1"># original child&#39;s label is curtailed</span>
            <span class="n">child</span><span class="o">.</span><span class="n">lab</span> <span class="o">=</span> <span class="n">lab</span><span class="p">[</span><span class="n">k</span><span class="o">-</span><span class="n">j</span><span class="p">:]</span>
            <span class="c1"># mid becomes new child of original parent</span>
            <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="n">mid</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="c1"># Fell off tree at a node: make new edge hanging off it</span>
          <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Node</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">:],</span><span class="n">i</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">followPath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Follow path given by s.  If we fall off tree, return None.  If we</span>
<span class="sd">        finish mid-edge, return (node, offset) where &#39;node&#39; is child and</span>
<span class="sd">        &#39;offset&#39; is label offset.  If we finish on a node, return (node,</span>
<span class="sd">        None). &quot;&quot;&quot;</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># fell off at a node</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">lab</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">lab</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">while</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">lab</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">):</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">child</span> <span class="c1"># exhausted edge</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">j</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="c1"># exhausted query string in middle of edge</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># fell off in the middle of the edge</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">cur</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># exhausted query string at internal node</span>

  <span class="k">def</span> <span class="nf">followPathMod</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Follow path given by s.  If we fall off tree, return None.  If we</span>
<span class="sd">        finish mid-edge, return (node, offset) where &#39;node&#39; is child and</span>
<span class="sd">        &#39;offset&#39; is label offset.  If we finish on a node, return (node,</span>
<span class="sd">        None). &quot;&quot;&quot;</span>
    <span class="n">cur</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">root</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">parent</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># the root not doesnt have parent node</span>
    <span class="n">cvs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">path_labs</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">c</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="c1"># fell off at a node</span>
        <span class="n">child</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">out</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
        <span class="n">lab</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">lab</span>
        <span class="n">idx</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="n">idx</span>
        <span class="n">cvs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
        <span class="n">path_labs</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">while</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">)</span> <span class="ow">and</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="n">lab</span><span class="p">[</span><span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">lab</span><span class="p">):</span>
            <span class="n">parent</span> <span class="o">=</span> <span class="n">cur</span>
            <span class="n">cur</span> <span class="o">=</span> <span class="n">child</span> <span class="c1"># exhausted edge</span>
            <span class="n">i</span> <span class="o">=</span> <span class="n">j</span>
        <span class="k">elif</span> <span class="n">j</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">(</span><span class="n">cur</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="n">i</span><span class="p">,</span> <span class="n">path_labs</span><span class="p">)</span> <span class="c1"># exhausted query string in middle of edge</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">path_labs</span><span class="p">)</span> <span class="c1"># fell off in the middle of the edge</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">path_labs</span><span class="p">)</span> <span class="c1"># exhausted query string at internal node</span>
  
  <span class="k">def</span> <span class="nf">LZ76encoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Performing the LZ76 parsing of T[1,n]. Outputs the $z$ of the</span>
<span class="sd">     LZ76 parsing of T.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">phrases</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">phrases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
      <span class="k">else</span><span class="p">:</span>  
        <span class="n">right_substring</span> <span class="o">=</span> <span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="p">]</span>
        <span class="n">node_end</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">lcvs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">followPathMod</span><span class="p">(</span><span class="n">right_substring</span><span class="p">)</span>
        <span class="c1">#print(&quot;i=&quot;,i, right_substring, node_end.idx, lcvs)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">lcvs</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">list</span><span class="p">(</span><span class="n">lcvs</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
   <span class="c1">#       print(t[i])</span>
          <span class="n">phrases</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
          <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">repi</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lcvs</span><span class="p">[</span><span class="nb">min</span><span class="p">(</span><span class="n">lcvs</span><span class="p">)])</span>
          <span class="n">li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">repi</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">li</span> <span class="o">&gt;=</span> <span class="n">i</span><span class="p">:</span>
           <span class="c1"># print(&quot;Here&quot;)</span>
           <span class="c1"># print(&quot;First&quot;,i, repi, li)</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="p">(</span><span class="n">li</span><span class="o">-</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="n">offset</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
              <span class="n">repi</span> <span class="o">=</span> <span class="n">repi</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
              <span class="n">repi</span> <span class="o">=</span> <span class="n">repi</span><span class="p">[:</span><span class="o">-</span><span class="n">offset</span><span class="p">]</span>
            <span class="n">li</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">repi</span><span class="p">)</span>
           <span class="c1"># print(&quot;Second&quot;,i, repi, li)</span>
          <span class="n">phrases</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="nb">min</span><span class="p">(</span><span class="n">lcvs</span><span class="p">),</span> <span class="n">li</span><span class="p">))</span>
          <span class="n">i</span> <span class="o">+=</span> <span class="n">li</span>
    <span class="k">return</span> <span class="n">phrases</span>
    
  <span class="k">def</span> <span class="nf">LZ76decoder</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">phrases</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
    <span class="n">T</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="n">phrases</span><span class="p">:</span>
      <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">T</span> <span class="o">+=</span> <span class="n">z</span>
      <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">:</span>
        <span class="n">si</span><span class="p">,</span> <span class="n">li</span> <span class="o">=</span> <span class="n">z</span>
        <span class="n">T</span> <span class="o">+=</span> <span class="n">T</span><span class="p">[</span><span class="n">si</span><span class="p">:</span><span class="n">si</span><span class="o">+</span><span class="n">li</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">T</span>
          
  <span class="k">def</span> <span class="nf">hasSubstring</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Return true iff s appears as a substring &quot;&quot;&quot;</span>
      <span class="n">node</span><span class="p">,</span> <span class="n">off</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">followPath</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">node</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>

  <span class="k">def</span> <span class="nf">hasSuffix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">s</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Return true iff s is a suffix &quot;&quot;&quot;</span>
      <span class="n">node</span><span class="p">,</span> <span class="n">off</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">followPath</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">node</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
          <span class="k">return</span> <span class="kc">False</span> <span class="c1"># fell off the tree</span>
      <span class="k">if</span> <span class="n">off</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
          <span class="c1"># finished on top of a node</span>
          <span class="k">return</span> <span class="s1">&#39;$&#39;</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">out</span>
      <span class="k">else</span><span class="p">:</span>
          <span class="c1"># finished at offset &#39;off&#39; within an edge leading to &#39;node&#39;</span>
          <span class="k">return</span> <span class="n">node</span><span class="o">.</span><span class="n">lab</span><span class="p">[</span><span class="n">off</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;$&#39;</span>

  <span class="k">def</span> <span class="nf">_iterate_over_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">reverse_dict</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">def</span> <span class="nf">_to_iter</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">reverse_dict</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
          <span class="n">reverse_dict</span><span class="p">[</span><span class="n">child</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
          <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Node lab=</span><span class="si">{}</span><span class="s2">, id=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">child</span><span class="o">.</span><span class="n">lab</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">idx</span><span class="p">))</span>
          <span class="n">_to_iter</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">reverse_dict</span><span class="p">)</span>
    <span class="n">_to_iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">reverse_dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">reverse_dict</span>
  
  <span class="k">def</span> <span class="nf">do_preorder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">preorder_traversal</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
      <span class="k">yield</span> <span class="n">root</span>
      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">preorder_traversal</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">preorder_traversal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">do_posorder</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">posorder_traversal</span><span class="p">(</span><span class="n">root</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">yield from</span> <span class="n">posorder_traversal</span><span class="p">(</span><span class="n">child</span><span class="p">)</span>
      <span class="k">yield</span> <span class="n">root</span>
    <span class="k">return</span> <span class="n">posorder_traversal</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>

  
  <span class="k">def</span> <span class="nf">rec_dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">S</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">S</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">S</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span> <span class="c1"># Initialize the history</span>
    <span class="n">S</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="c1"># We&#39;ve visited s</span>
<span class="c1">#    print(root.lab, root.idx)</span>
    <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">():</span> <span class="c1"># Explore neighbors</span>
      <span class="k">if</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">S</span><span class="p">:</span> <span class="k">continue</span> <span class="c1"># Already visited: Skip</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">rec_dfs</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">S</span><span class="p">)</span> <span class="c1"># New: Explore recursively</span>
    <span class="k">return</span> <span class="n">S</span>
    
  <span class="k">def</span> <span class="nf">do_rec_dfs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_dfs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>
  
  <span class="k">def</span> <span class="nf">enumerate_internal_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">stree_pre</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">do_preorder</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">([(</span><span class="n">x</span><span class="o">.</span><span class="n">lab</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">idx</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">stree_pre</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stree_pre</span><span class="p">)):</span>
      <span class="k">if</span> <span class="n">stree_pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">stree_pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">n</span><span class="o">.</span><span class="n">idx</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">stree_pre</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">idx</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">])</span>
        
  <span class="k">def</span> <span class="nf">enumerate_internal_nodes2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">stree_pre</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">do_posorder</span><span class="p">())</span>
<span class="c1">#    print([(x.lab, x.idx) for x in stree_pre])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stree_pre</span><span class="p">)):</span>
      <span class="k">if</span> <span class="n">stree_pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="c1">#         print(stree_pre[i].lab, min([x.idx for x in self.rec_dfs(stree_pre[i]) if x.idx != None]))</span>
        <span class="n">stree_pre</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">idx</span> <span class="o">=</span> <span class="nb">min</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">idx</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">rec_dfs</span><span class="p">(</span><span class="n">stree_pre</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">idx</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">])</span>
<span class="c1">#         print(&quot;=============&quot;)</span>
<span class="c1">#        stree_pre[i].idx = min([n.idx for n in stree_pre[i:] if n.idx != None])</span>
    
  <span class="k">def</span> <span class="nf">to_dot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
      <span class="sd">&quot;&quot;&quot; Return dot representation of trie to make a picture &quot;&quot;&quot;</span>
      <span class="n">lines</span> <span class="o">=</span> <span class="p">[]</span>
      <span class="k">def</span> <span class="nf">_to_dot_helper</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">parid</span><span class="p">):</span>
          <span class="n">childid</span> <span class="o">=</span> <span class="n">parid</span>
          <span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">node</span><span class="o">.</span><span class="n">out</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
<span class="c1">#              print(c, child)</span>
              <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">%d</span><span class="s1"> -&gt; </span><span class="si">%d</span><span class="s1"> [ label=&quot;</span><span class="si">%s</span><span class="s1">&quot; ];&#39;</span> <span class="o">%</span> 
                           <span class="p">(</span><span class="n">parid</span><span class="p">,</span> <span class="n">childid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">lab</span><span class="p">))</span>
              <span class="k">if</span> <span class="n">child</span><span class="o">.</span><span class="n">idx</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  </span><span class="si">{}</span><span class="s1"> [label=&quot;</span><span class="si">{}</span><span class="s1">&quot;];&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">childid</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">child</span><span class="o">.</span><span class="n">idx</span><span class="p">))</span>
              <span class="n">childid</span> <span class="o">=</span> <span class="n">_to_dot_helper</span><span class="p">(</span><span class="n">child</span><span class="p">,</span> <span class="n">childid</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
          <span class="k">return</span> <span class="n">childid</span>
      <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;digraph &quot;Suffix trie&quot; {&#39;</span><span class="p">)</span>
      <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  node [shape=circle label=&quot;&quot;];&#39;</span><span class="p">)</span>
      <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;  0 [label=&quot;</span><span class="si">{}</span><span class="s1">&quot;];&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">idx</span><span class="p">))</span>
      <span class="n">_to_dot_helper</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
      <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;}&#39;</span><span class="p">)</span>
      <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#stree = SuffixTreeLZ76(&#39;abbacbba&#39;)</span>
<span class="c1">#stree = SuffixTreeLZ76(&#39;abaaba&#39;)</span>
<span class="n">stree</span> <span class="o">=</span> <span class="n">SuffixTreeLZ76</span><span class="p">(</span><span class="s1">&#39;mississippi&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stree</span><span class="o">.</span><span class="n">enumerate_internal_nodes2</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[11]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">dotstr</span> stree.to_dot()
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>



<div class="output_svg output_subarea ">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Suffix trie Pages: 1 -->
<svg width="374pt" height="315pt"
 viewBox="0.00 0.00 374.00 314.89" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 310.8927)">
<title>Suffix trie</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-310.8927 370,-310.8927 370,4 -4,4"/>
<!-- 0 -->
<g id="node1" class="node">
<title>0</title>
<ellipse fill="none" stroke="#000000" cx="219" cy="-288.8927" rx="18" ry="18"/>
<text text-anchor="middle" x="219" y="-285.1927" font-family="Times,serif" font-size="14.00" fill="#000000">0</text>
</g>
<!-- 1 -->
<g id="node2" class="node">
<title>1</title>
<ellipse fill="none" stroke="#000000" cx="75" cy="-199.7445" rx="18" ry="18"/>
<text text-anchor="middle" x="75" y="-196.0445" font-family="Times,serif" font-size="14.00" fill="#000000">0</text>
</g>
<!-- 0&#45;&gt;1 -->
<g id="edge1" class="edge">
<title>0&#45;&gt;1</title>
<path fill="none" stroke="#000000" d="M201.1599,-285.7426C170.7253,-280.0465 110.5472,-267.2815 95,-252.8927 87.7203,-246.1555 83.0735,-236.5049 80.1144,-227.2714"/>
<polygon fill="#000000" stroke="#000000" points="83.4857,-226.3299 77.5212,-217.5735 76.7233,-228.1382 83.4857,-226.3299"/>
<text text-anchor="middle" x="130" y="-241.6927" font-family="Times,serif" font-size="14.00" fill="#000000">mississippi$</text>
</g>
<!-- 2 -->
<g id="node3" class="node">
<title>2</title>
<ellipse fill="none" stroke="#000000" cx="129" cy="-199.7445" rx="18" ry="18"/>
<text text-anchor="middle" x="129" y="-196.0445" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- 0&#45;&gt;2 -->
<g id="edge2" class="edge">
<title>0&#45;&gt;2</title>
<path fill="none" stroke="#000000" d="M206.1052,-276.12C191.2685,-261.4237 166.7162,-237.1038 149.3067,-219.859"/>
<polygon fill="#000000" stroke="#000000" points="151.4386,-217.0444 141.8709,-212.4936 146.5124,-222.0176 151.4386,-217.0444"/>
<text text-anchor="middle" x="185" y="-241.6927" font-family="Times,serif" font-size="14.00" fill="#000000">i</text>
</g>
<!-- 8 -->
<g id="node9" class="node">
<title>8</title>
<ellipse fill="none" stroke="#000000" cx="219" cy="-199.7445" rx="18" ry="18"/>
<text text-anchor="middle" x="219" y="-196.0445" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- 0&#45;&gt;8 -->
<g id="edge8" class="edge">
<title>0&#45;&gt;8</title>
<path fill="none" stroke="#000000" d="M219,-270.8523C219,-258.5271 219,-241.9466 219,-227.8966"/>
<polygon fill="#000000" stroke="#000000" points="222.5001,-227.7581 219,-217.7582 215.5001,-227.7582 222.5001,-227.7581"/>
<text text-anchor="middle" x="222" y="-241.6927" font-family="Times,serif" font-size="14.00" fill="#000000">s</text>
</g>
<!-- 15 -->
<g id="node16" class="node">
<title>15</title>
<ellipse fill="none" stroke="#000000" cx="283" cy="-199.7445" rx="18" ry="18"/>
<text text-anchor="middle" x="283" y="-196.0445" font-family="Times,serif" font-size="14.00" fill="#000000">8</text>
</g>
<!-- 0&#45;&gt;15 -->
<g id="edge15" class="edge">
<title>0&#45;&gt;15</title>
<path fill="none" stroke="#000000" d="M229.5683,-274.1717C239.5736,-260.2349 254.7523,-239.0919 266.3781,-222.8978"/>
<polygon fill="#000000" stroke="#000000" points="269.4273,-224.652 272.416,-214.4874 263.7409,-220.5697 269.4273,-224.652"/>
<text text-anchor="middle" x="259" y="-241.6927" font-family="Times,serif" font-size="14.00" fill="#000000">p</text>
</g>
<!-- 18 -->
<g id="node19" class="node">
<title>18</title>
<ellipse fill="none" stroke="#000000" cx="339" cy="-199.7445" rx="20.2975" ry="20.2975"/>
<text text-anchor="middle" x="339" y="-196.0445" font-family="Times,serif" font-size="14.00" fill="#000000">11</text>
</g>
<!-- 0&#45;&gt;18 -->
<g id="edge18" class="edge">
<title>0&#45;&gt;18</title>
<path fill="none" stroke="#000000" d="M233.7144,-277.9614C253.8686,-262.9888 290.3211,-235.9081 314.5967,-217.8738"/>
<polygon fill="#000000" stroke="#000000" points="316.6887,-220.6798 322.6288,-211.9067 312.5143,-215.0607 316.6887,-220.6798"/>
<text text-anchor="middle" x="291" y="-241.6927" font-family="Times,serif" font-size="14.00" fill="#000000">$</text>
</g>
<!-- 3 -->
<g id="node4" class="node">
<title>3</title>
<ellipse fill="none" stroke="#000000" cx="18" cy="-107.7982" rx="18" ry="18"/>
<text text-anchor="middle" x="18" y="-104.0982" font-family="Times,serif" font-size="14.00" fill="#000000">7</text>
</g>
<!-- 2&#45;&gt;3 -->
<g id="edge3" class="edge">
<title>2&#45;&gt;3</title>
<path fill="none" stroke="#000000" d="M114.7387,-188.4137C110.714,-185.4076 106.2669,-182.2598 102,-179.5963 87.1616,-170.3337 80.8878,-172.2313 67,-161.5963 55.2866,-152.6264 44.0632,-140.6449 35.3202,-130.2662"/>
<polygon fill="#000000" stroke="#000000" points="37.9133,-127.908 28.8784,-122.3744 32.4905,-132.3345 37.9133,-127.908"/>
<text text-anchor="middle" x="80.5" y="-150.3963" font-family="Times,serif" font-size="14.00" fill="#000000">ppi$</text>
</g>
<!-- 4 -->
<g id="node5" class="node">
<title>4</title>
<ellipse fill="none" stroke="#000000" cx="72" cy="-107.7982" rx="18" ry="18"/>
<text text-anchor="middle" x="72" y="-104.0982" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- 2&#45;&gt;4 -->
<g id="edge4" class="edge">
<title>2&#45;&gt;4</title>
<path fill="none" stroke="#000000" d="M119.3307,-184.1471C110.4333,-169.7947 97.1038,-148.293 86.8554,-131.7613"/>
<polygon fill="#000000" stroke="#000000" points="89.7702,-129.8204 81.5265,-123.1653 83.8207,-133.5087 89.7702,-129.8204"/>
<text text-anchor="middle" x="111.5" y="-150.3963" font-family="Times,serif" font-size="14.00" fill="#000000">ssi</text>
</g>
<!-- 7 -->
<g id="node8" class="node">
<title>7</title>
<ellipse fill="none" stroke="#000000" cx="129" cy="-107.7982" rx="20.5982" ry="20.5982"/>
<text text-anchor="middle" x="129" y="-104.0982" font-family="Times,serif" font-size="14.00" fill="#000000">10</text>
</g>
<!-- 2&#45;&gt;7 -->
<g id="edge7" class="edge">
<title>2&#45;&gt;7</title>
<path fill="none" stroke="#000000" d="M129,-181.5789C129,-169.4844 129,-153.277 129,-139.1334"/>
<polygon fill="#000000" stroke="#000000" points="132.5001,-138.8222 129,-128.8223 125.5001,-138.8223 132.5001,-138.8222"/>
<text text-anchor="middle" x="133" y="-150.3963" font-family="Times,serif" font-size="14.00" fill="#000000">$</text>
</g>
<!-- 5 -->
<g id="node6" class="node">
<title>5</title>
<ellipse fill="none" stroke="#000000" cx="18" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="18" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">4</text>
</g>
<!-- 4&#45;&gt;5 -->
<g id="edge5" class="edge">
<title>4&#45;&gt;5</title>
<path fill="none" stroke="#000000" d="M59.922,-94.4119C53.7858,-87.2056 46.4881,-77.9734 41,-69 36.3163,-61.3419 32.0167,-52.566 28.4343,-44.4777"/>
<polygon fill="#000000" stroke="#000000" points="31.5718,-42.9114 24.4427,-35.074 25.1283,-45.6466 31.5718,-42.9114"/>
<text text-anchor="middle" x="54.5" y="-57.8" font-family="Times,serif" font-size="14.00" fill="#000000">ppi$</text>
</g>
<!-- 6 -->
<g id="node7" class="node">
<title>6</title>
<ellipse fill="none" stroke="#000000" cx="72" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="72" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">1</text>
</g>
<!-- 4&#45;&gt;6 -->
<g id="edge6" class="edge">
<title>4&#45;&gt;6</title>
<path fill="none" stroke="#000000" d="M72,-89.6262C72,-77.2112 72,-60.5097 72,-46.3573"/>
<polygon fill="#000000" stroke="#000000" points="75.5001,-46.1449 72,-36.145 68.5001,-46.145 75.5001,-46.1449"/>
<text text-anchor="middle" x="92.5" y="-57.8" font-family="Times,serif" font-size="14.00" fill="#000000">ssippi$</text>
</g>
<!-- 9 -->
<g id="node10" class="node">
<title>9</title>
<ellipse fill="none" stroke="#000000" cx="186" cy="-107.7982" rx="18" ry="18"/>
<text text-anchor="middle" x="186" y="-104.0982" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- 8&#45;&gt;9 -->
<g id="edge9" class="edge">
<title>8&#45;&gt;9</title>
<path fill="none" stroke="#000000" d="M212.793,-182.4501C207.9532,-168.9654 201.1463,-149.9997 195.6047,-134.5594"/>
<polygon fill="#000000" stroke="#000000" points="198.8516,-133.2448 192.1792,-125.015 192.2631,-135.6095 198.8516,-133.2448"/>
<text text-anchor="middle" x="207" y="-150.3963" font-family="Times,serif" font-size="14.00" fill="#000000">i</text>
</g>
<!-- 12 -->
<g id="node13" class="node">
<title>12</title>
<ellipse fill="none" stroke="#000000" cx="240" cy="-107.7982" rx="18" ry="18"/>
<text text-anchor="middle" x="240" y="-104.0982" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- 8&#45;&gt;12 -->
<g id="edge12" class="edge">
<title>8&#45;&gt;12</title>
<path fill="none" stroke="#000000" d="M223.049,-182.0163C226.0704,-168.7875 230.2553,-150.4644 233.7109,-135.3345"/>
<polygon fill="#000000" stroke="#000000" points="237.1489,-136.0002 235.9634,-125.4719 230.3246,-134.4415 237.1489,-136.0002"/>
<text text-anchor="middle" x="236" y="-150.3963" font-family="Times,serif" font-size="14.00" fill="#000000">si</text>
</g>
<!-- 10 -->
<g id="node11" class="node">
<title>10</title>
<ellipse fill="none" stroke="#000000" cx="134" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="134" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">6</text>
</g>
<!-- 9&#45;&gt;10 -->
<g id="edge10" class="edge">
<title>9&#45;&gt;10</title>
<path fill="none" stroke="#000000" d="M173.9893,-94.0349C168.1054,-86.8766 161.1893,-77.8016 156,-69 151.4737,-61.3229 147.3481,-52.5418 143.9239,-44.4545"/>
<polygon fill="#000000" stroke="#000000" points="147.1144,-43.0083 140.1152,-35.0546 140.6268,-45.6371 147.1144,-43.0083"/>
<text text-anchor="middle" x="169.5" y="-57.8" font-family="Times,serif" font-size="14.00" fill="#000000">ppi$</text>
</g>
<!-- 11 -->
<g id="node12" class="node">
<title>11</title>
<ellipse fill="none" stroke="#000000" cx="188" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="188" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">3</text>
</g>
<!-- 9&#45;&gt;11 -->
<g id="edge11" class="edge">
<title>9&#45;&gt;11</title>
<path fill="none" stroke="#000000" d="M186.3007,-89.372C186.4807,-78.9836 186.7272,-65.7672 187,-54 187.0562,-51.5739 187.1184,-49.056 187.1834,-46.5298"/>
<polygon fill="#000000" stroke="#000000" points="190.688,-46.404 187.4588,-36.3133 183.6905,-46.2153 190.688,-46.404"/>
<text text-anchor="middle" x="207.5" y="-57.8" font-family="Times,serif" font-size="14.00" fill="#000000">ssippi$</text>
</g>
<!-- 13 -->
<g id="node14" class="node">
<title>13</title>
<ellipse fill="none" stroke="#000000" cx="250" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="250" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">5</text>
</g>
<!-- 12&#45;&gt;13 -->
<g id="edge13" class="edge">
<title>12&#45;&gt;13</title>
<path fill="none" stroke="#000000" d="M242.0236,-89.6262C243.4062,-77.2112 245.2661,-60.5097 246.8421,-46.3573"/>
<polygon fill="#000000" stroke="#000000" points="250.351,-46.4709 247.9794,-36.145 243.394,-45.6961 250.351,-46.4709"/>
<text text-anchor="middle" x="259.5" y="-57.8" font-family="Times,serif" font-size="14.00" fill="#000000">ppi$</text>
</g>
<!-- 14 -->
<g id="node15" class="node">
<title>14</title>
<ellipse fill="none" stroke="#000000" cx="304" cy="-18" rx="18" ry="18"/>
<text text-anchor="middle" x="304" y="-14.3" font-family="Times,serif" font-size="14.00" fill="#000000">2</text>
</g>
<!-- 12&#45;&gt;14 -->
<g id="edge14" class="edge">
<title>12&#45;&gt;14</title>
<path fill="none" stroke="#000000" d="M253.6303,-95.3059C261.0746,-88.0631 270.1449,-78.5156 277,-69 282.6163,-61.204 287.8139,-52.0915 292.1183,-43.7429"/>
<polygon fill="#000000" stroke="#000000" points="295.2692,-45.267 296.5734,-34.7527 288.9971,-42.1589 295.2692,-45.267"/>
<text text-anchor="middle" x="307.5" y="-57.8" font-family="Times,serif" font-size="14.00" fill="#000000">ssippi$</text>
</g>
<!-- 16 -->
<g id="node17" class="node">
<title>16</title>
<ellipse fill="none" stroke="#000000" cx="294" cy="-107.7982" rx="18" ry="18"/>
<text text-anchor="middle" x="294" y="-104.0982" font-family="Times,serif" font-size="14.00" fill="#000000">9</text>
</g>
<!-- 15&#45;&gt;16 -->
<g id="edge16" class="edge">
<title>15&#45;&gt;16</title>
<path fill="none" stroke="#000000" d="M285.1732,-181.5789C286.725,-168.6078 288.8428,-150.9059 290.615,-136.0928"/>
<polygon fill="#000000" stroke="#000000" points="294.1185,-136.271 291.8313,-125.9261 287.1681,-135.4395 294.1185,-136.271"/>
<text text-anchor="middle" x="296" y="-150.3963" font-family="Times,serif" font-size="14.00" fill="#000000">i$</text>
</g>
<!-- 17 -->
<g id="node18" class="node">
<title>17</title>
<ellipse fill="none" stroke="#000000" cx="348" cy="-107.7982" rx="18" ry="18"/>
<text text-anchor="middle" x="348" y="-104.0982" font-family="Times,serif" font-size="14.00" fill="#000000">8</text>
</g>
<!-- 15&#45;&gt;17 -->
<g id="edge17" class="edge">
<title>15&#45;&gt;17</title>
<path fill="none" stroke="#000000" d="M293.4434,-184.9717C303.7726,-170.3605 319.7298,-147.788 331.723,-130.8229"/>
<polygon fill="#000000" stroke="#000000" points="334.6679,-132.7203 337.5825,-122.5343 328.952,-128.6795 334.6679,-132.7203"/>
<text text-anchor="middle" x="329.5" y="-150.3963" font-family="Times,serif" font-size="14.00" fill="#000000">pi$</text>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ol>
<li><p>Construir a árvore de sufixos</p>
</li>
<li><p>Enumerar os nós internos com o menor valor encontrado em sua subárvore.</p>
</li>
<li><p>Varremos a string T em busca da substring encontrada anteriormente. Para cada i em T temos a substring a seguir, T[i:m], onde m é o tamanho da palavra.</p>
<p>3.1. Seguimos o caminho na árvore de sufixo correspondente a subpalavra T[i:m] mantendo o menor valor encontrado nos nós internos percorridos (ps: o valor encontrado nas leafs não nos interessa).</p>
<p>3.2. Quando o menor valor encontrado é igual ao índice da palavra, isso quer dizer que o caractere correspondente ao índice i não foi encontrado anteriormente. Output esse caractere.</p>
<p>3.3. Quando não nos deparamos com nós internos ao longo do caminho de match, significa que tmb nao encontramos o caractere i anteriormente. Output i.</p>
<p>3.4. Quando nos deparamos com um caminho com mais de um nó interno com mesmo valor. Output do conjunto de labels que correspondem a estes nós. Output (posicao = menor valor encontrado, tamanho da string correspondente aos nós de menor valor encontrado)</p>
<p>3.5. Pulamos os caracteres de output e continuamos com o algoritmo até percorrer toda a string.</p>
</li>
</ol>
<p><strong>Implementation details</strong>: I dont know if the complexity time is $O(m)$ because my implementation is matching every $T[i..m]$ for all i $\in$ {0..m}. So, maybe it's complexity is growing in order $m^2$ instead of $m$. But, when I find a previous matche, i.e. a portion of the text that can be compressed, the algorithm jumps the lenght of the compressed part. This may be contributing to lower the running time.</p>
<p>The algorithm perform the enumeration of all internal nodes through the creation of a subtree for each internal node, and them keeps the minimum value found in a leaf belonging to the subtree. Since we have to enumerate the internal nodes from in a bottom-up fashion we first sort the nodes in pos-order. We iterate over the pos-order vector of nodes creating the subtree for each internal node found.</p>
<p>I've used a dictionary to keep track of numbers in the internal nodes encountered and their labels when the algorithm traverses a path from root to $p$. This code is implemented on function <code>followPathMod()</code>. This may be a naive method because we always store a dictionary with all the paths and labels and this can be a burden to very deep suffix trees. Another cavet of the implementation was already mentioned and is related to the fact that every time we traverses all the remaining string. This could be avoided contrainting the traverse to a number of characters equal to the index i of $T[i..m]$ because we can only have previous substrings of length $i$.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">node_end</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">lcvs</span> <span class="o">=</span> <span class="n">stree</span><span class="o">.</span><span class="n">followPathMod</span><span class="p">(</span><span class="s1">&#39;mississippi$&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zs</span> <span class="o">=</span> <span class="n">stree</span><span class="o">.</span><span class="n">LZ76encoder</span><span class="p">(</span><span class="s1">&#39;mississippi$&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[15]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[15]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;m&#39;, &#39;i&#39;, &#39;s&#39;, (2, 1), (1, 1), (2, 3), &#39;p&#39;, (8, 1), (1, 1), &#39;$&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[16]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stree</span><span class="o">.</span><span class="n">LZ76decoder</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[16]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;mississippi$&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stree</span> <span class="o">=</span> <span class="n">SuffixTreeLZ76</span><span class="p">(</span><span class="s1">&#39;how_can_a_clam_cram_in_a_clean_cream_can&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stree</span><span class="o">.</span><span class="n">enumerate_internal_nodes2</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zs</span> <span class="o">=</span> <span class="n">stree</span><span class="o">.</span><span class="n">LZ76encoder</span><span class="p">(</span><span class="s1">&#39;how_can_a_clam_cram_in_a_clean_cream_can$&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[20]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">zs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[20]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>[&#39;h&#39;,
 &#39;o&#39;,
 &#39;w&#39;,
 &#39;_&#39;,
 &#39;c&#39;,
 &#39;a&#39;,
 &#39;n&#39;,
 (3, 1),
 (5, 1),
 (3, 2),
 &#39;l&#39;,
 (5, 1),
 &#39;m&#39;,
 (3, 2),
 &#39;r&#39;,
 (5, 1),
 (13, 2),
 &#39;i&#39;,
 (6, 6),
 &#39;e&#39;,
 (5, 3),
 (4, 1),
 (16, 1),
 (27, 2),
 (13, 3),
 (5, 2),
 &#39;$&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[21]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">stree</span><span class="o">.</span><span class="n">LZ76decoder</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[21]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>&#39;how_can_a_clam_cram_in_a_clean_cream_can$&#39;</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[22]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> pip install ncbi-acc-download
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>Collecting ncbi-acc-download
  Downloading https://files.pythonhosted.org/packages/90/51/0eff82de3ccf845ff8cf694614183aa17aac2cf41d7d9fd362bc7a50f3b3/ncbi_acc_download-0.2.5-py2.py3-none-any.whl
Requirement already satisfied: requests&gt;=2.4.3 in /usr/local/lib/python3.6/dist-packages (from ncbi-acc-download) (2.21.0)
Requirement already satisfied: urllib3&lt;1.25,&gt;=1.21.1 in /usr/local/lib/python3.6/dist-packages (from requests&gt;=2.4.3-&gt;ncbi-acc-download) (1.24.3)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/local/lib/python3.6/dist-packages (from requests&gt;=2.4.3-&gt;ncbi-acc-download) (2019.9.11)
Requirement already satisfied: chardet&lt;3.1.0,&gt;=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests&gt;=2.4.3-&gt;ncbi-acc-download) (3.0.4)
Requirement already satisfied: idna&lt;2.9,&gt;=2.5 in /usr/local/lib/python3.6/dist-packages (from requests&gt;=2.4.3-&gt;ncbi-acc-download) (2.8)
Installing collected packages: ncbi-acc-download
Successfully installed ncbi-acc-download-0.2.5
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> ncbi-acc-download -m nucleotide -F fasta NC_001416.1
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[24]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">!</span> head NC_001416.1.fa
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt"></div>


<div class="output_subarea output_stream output_stdout output_text">
<pre>&gt;NC_001416.1 Enterobacteria phage lambda, complete genome
GGGCGGCGACCTCGCGGGTTTTCGCTATTTATGAAAATTTTCCGGTTTAAGGCGTTTCCGTTCTTCTTCG
TCATAACTTAATGTTTTTATTTAAAATACCCTCTGAAAAGAAAGGAAACGACAGGTGCTGAAAGCGAGGC
TTTTTGGCCTCTGTCGTTTCCTTTCTCTGTTTTTGTCCGTGGAATGAACAATGGAAGTCAACAAAAAGCA
GCTGGCTGACATTTTCGGTGCGAGTATCCGTACCATTCAGAACTGGCAGGAACAGGGAATGCCCGTTCTG
CGAGGCGGTGGCAAGGGTAATGAGGTGCTTTATGACTCTGCCGCCGTCATAAAATGGTATGCCGAAAGGG
ATGCTGAAATTGAGAACGAAAAGCTGCGCCGGGAGGTTGAAGAACTGCGGCAGGCCAGCGAGGCAGATCT
CCAGCCAGGAACTATTGAGTACGAACGCCATCGACTTACGCGTGCGCAGGCCGACGCACAGGAACTGAAG
AATGCCAGAGACTCCGCTGAAGTGGTGGAAACCGCATTCTGTACTTTCGTGCTGTCGCGGATCGCAGGTG
AAATTGCCAGTATTCTCGACGGGCTCCCCCTGTCGGTGCAGCGGCGTTTTCCGGAACTGGAAAACCGACA
</pre>
</div>
</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phage_geno</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;NC_001416.1.fa&#39;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">phagefa</span><span class="p">:</span>
  <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">phagefa</span><span class="o">.</span><span class="n">readlines</span><span class="p">():</span>
    <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&gt;&#39;</span><span class="p">):</span>
      <span class="k">continue</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="n">phage_geno</span> <span class="o">+=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[26]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">phage_geno</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[26]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>48502</pre>
</div>

</div>

</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_500_bp</span> <span class="o">=</span> <span class="n">phage_geno</span><span class="p">[:</span><span class="mi">500</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phaST</span> <span class="o">=</span> <span class="n">SuffixTreeLZ76</span><span class="p">(</span><span class="n">first_500_bp</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phaST</span><span class="o">.</span><span class="n">enumerate_internal_nodes2</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">first_500_bp_aug</span> <span class="o">=</span> <span class="n">first_500_bp</span><span class="o">+</span><span class="s1">&#39;$&#39;</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># %dotstr phaST.to_dot()</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[0]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">phaST</span><span class="o">.</span><span class="n">LZ76encoder</span><span class="p">(</span><span class="n">first_500_bp_aug</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In&nbsp;[33]:</div>
<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phaST</span><span class="o">.</span><span class="n">LZ76decoder</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="n">first_500_bp_aug</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">


<div class="output_area">

    <div class="prompt output_prompt">Out[33]:</div>




<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
 


<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
        </div>

        <div class="meta">
            <div>
                    <a href="/tag/simulation.html" class="tag">simulation</a>
                    <a href="/tag/statistics.html" class="tag">statistics</a>
            </div>
        </div>
    </article>


</div>

<style type="text/css">
{
    max-width: 700px;
}

.text_cell .prompt {
    display: none;
}

div.cell {
    padding: 0;
}

div.text_cell_render {
    padding: 0;
}

div.prompt {
    font-size: 13px;
}

div.input_prompt {
    padding: .7em 0.2em;
}

div.output_prompt {
    padding: .4em .2em;
}

div.input_area {
    margin: .2em 0.4em;
    max-width: 580px;
}

table.dataframe {
    font-family: Arial, sans-serif;
    font-size: 13px;
    line-height: 20px;
}

table.dataframe th, td {
    padding: 4px;
    text-align: left;
}

pre code {
    background-color: inherit;
}</style>

        </div>
<!--
    <footer>
      <p>
        © 2012-2017 Rodrigo Theodoro, license <a href="https://github.com/jakevdp/jakevdp.github.io-source/blob/master/LICENSE"> </a>
        unless otherwise noted.
        Generated by <a href= "http://docs.getpelican.com/">Pelican</a>.
      </p>
    </footer>
-->
    </body>
</html>